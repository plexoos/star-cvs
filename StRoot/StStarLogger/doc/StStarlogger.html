<html>
<title>STAR logger</title>
<body>
<pre>

     ***************************************************************
     ***************************************************************
     **** STAR logger:  The STAR offline logger-based message manager ****
     ***************************************************************
     ***************************************************************
STAR logger is a the logger-based implementation of <a href="http://www.star.bnl.gov/STAR/comp/sofi/StMessMgr">
STAR message manager interface</a>


Table of Contents:

Section I. Basic usage: creating a message
<ul>
<li><a href="#logger">Intergration log4j package for STAR framework</a>
<li><a href="#makers">Logger for STAR Makers</a>
<li><a href="#macros">New macros</a>
<li><a href="#use">How to use</a>
<li><a href="#conf">How to configure</a>
<li><a href="#print">"Print statement" transition</a>
</ul>
<a name="#logger"></a>
<h1> Intergration log4j package for STAR framework</h1>


  Integration of the log4j packages and STAR offline framework 
  was straightforward due to an already existing OO  
  <a href="http://www.star.bnl.gov/STAR/comp/sofi/StMessMgr">design</a> 
  for processing message streams.  
<p>
  Most (if not all) components of the STAR production 
  framework send their log messages to the abstract STAR messenger. 
  To merge the STAR existing framework with the log4j package, 
  it was only a matter of creating another implementation of 
  the STAR messenger interface. Additionally, and to meet 
  the STAR production needs, a standard set of the logger 
  appender and filter features were either developed or enhanced. 
  We added one extra appender to communicate with the STAR 
  production MySQL database and created a custom logger filter 
  to be able to select/suspend the messages according to the 
  STAR production manager's criteria. Once again, and due to 
  the already existing OO messenger implementation in the 
  STAR production system, enabling the new scheme did not 
  require modifying any existing piece of the STAR code. 
  It was sufficient to dynamically load the new implementation 
  and provide an external XML configuration file for the logger as needed. 

<a name="#makers"></a>
<h1> Logger for STAR Makers  </h1>

  With new implementation each STAR StMaker subclass instantiate 
  its own logger. The logger name is the subclass class name.
  This allows to set the logger list of appenders, filters and level of 
  the severity for entire production chain or / and for each STAR maker subclass separately.
  The end user code is not to worry about the proper selection of the appropriated logger.
  The user via set of the CPP <a href="#macros">macro</a> or 
  via the "#i1">global pointer</a>
  communicate with the so-called "current logger".
   The base StMaker class internally governs the logger selection to make sure he current
  logger  matches the logger of the current active StMaker instance.

<a name="#macros"></a>
<h1> New macros </h1>

The base STAR message manager abstract interface was improved to provide better performance.
It is recommended now istaed of direct ise of the Messager global pointer apply the CPP macros
 as follows:
 
<ul>    
  <li> <b><code>LOG_INFO</code></a> </b>
  <li> <b><code>LOG_WARN</code></a> </b>
  <li> <b><code>LOG_ERROR</code></a> </b>
  <li> <b><code>LOG_FATAL</code></a> </b>
  <li> <b><code>LOG_DEBUG</code></a> </b>
  <li> <b><code>LOG_QA</code></a> </b>
</ul>
are followed by the C++ output "stream" elements  and ended up with the "endm" object.
For example, to direct the message to the "error" logger on needs:

<b><code> <pre>
  LOG_ERROR << "My error message" << endm;
</pre>  </code> </b>

<a name="#use"></a>
<h1> How to use New macros </h1>

By default STAR "roto4star" framework works with the old STAR message manager implementation.

<p>
  Ti turn the new one one should load the extra shared library.
  The ROOT macros <code>LoadLogger.C</code> does just that.
  This means to instantiate the new logger it is enough to call "LoadLogger.C" before invoking your ROTO macro. 
  <p>
   For example to get BFC.C works with the new logger schema one needs to start the "root4star" session and call TWO macros:
   <b><code>
   <pre>
     root4star
     .x LoadLogger.C
     .x Bfc.C(1, . . . )
   </pre>
   </code></b>
 <p>
    As soon as the new logger is loaded the output files, format and level of 
   the verbosity may be defined by the extrenal Logger configuration file.
   It recommenend to avoid using any method of the STAR message m,anager describing with 
   <a href="http://www.star.bnl.gov/STAR/comp/sofi/StMessMgr"> document</a> and use <a href"#macros">the macros</a>
   mentioned above only. This is to make the ocde free of the run-time and compilation 
   time parameters this can be defined via the logger configuration file.
 <p>
   
   In other words the author of the code should not apply the "Adanced methods" described by   
   <a href="http://www.star.bnl.gov/STAR/comp/sofi/StMessMgr"> "Section II"</a> 
   from the use code as soon as this can be done outside of the code at run-time.
 <p>
   It is enough to define the desirable messages and its level. All other features can be ordered with the configuration 
   file at run-time without any needs to change and re-compile the code.
 <a name="#conf"></a>
<h1>How to configure</h1>
<a name="#print"></a>
<h1> "Print statement" transition</h1>

</body>
</html>
