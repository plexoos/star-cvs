<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>StDetectorDbRichScalers.cxx Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.8.1 -->
<center>
<a class="qindex" href="main.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>StDetectorDbRichScalers.cxx</h1><a href="StDetectorDbRichScalers_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="preprocessor">#include "<a class="code" href="StDetectorDbRichScalers_8h.html">StDetectorDbRichScalers.h</a>"</font>
00002 <font class="preprocessor">#include "<a class="code" href="StDetectorDbInterpolator_8h.html">StDetectorDbInterpolator.h</a>"</font>
00003 <font class="preprocessor">#include "TDataSet.h"</font>
00004 <font class="preprocessor">#include "TTable.h"</font>
00005 <font class="preprocessor">#include "StMaker.h"</font>
00006 <font class="comment"></font>
00007 <font class="comment">/// Needs a StMaker* passed in. This is because GetDatabase only works in a maker class. So this must be declared inside a maker.</font>
<a name="l00008"></a><a class="code" href="classStDetectorDbRichScalers.html#a0">00008</a> <font class="comment"></font><a class="code" href="classStDetectorDbRichScalers.html#a0">StDetectorDbRichScalers::StDetectorDbRichScalers</a>(StMaker* maker)<font class="keyword"></font>{
00009     cout &lt;&lt; <font class="stringliteral">"StDetectorDbRichScalers::StDetectorDbRichScalers"</font> &lt;&lt; endl;
00010     mRunNumber = 0;
00011     mTimes = 0;
00012     mCTBWest = 0;
00013     mCTBEast = 0;
00014     mCTBOR = 0;
00015     mTOFp = 0;
00016     mZDCWest = 0;
00017     mZDCEast = 0;
00018     mZDCX = 0;
00019     mMult = 0;
00020     mL0 = 0;
00021 
00022     <font class="keywordflow">if</font>(maker){
00023         mEventTime = maker-&gt;GetDateTime().Convert() - 14400; <font class="comment">//convert to GMT</font>
00024         
00025         TDataSet* dataSet = maker-&gt;GetDataBase(<font class="stringliteral">"RunLog/rhic"</font>);
00026         
00027         <font class="keywordflow">if</font>(dataSet){
00028             TTable* table = dynamic_cast&lt;TTable*&gt;(dataSet-&gt;Find(<font class="stringliteral">"trigDetSums"</font>));
00029             <font class="keywordflow">if</font>(table){
00030                 mNumEntries = table-&gt;GetNRows() ;
00031                 <font class="keywordflow">if</font>(mNumEntries){
00032                     <a class="code" href="structtrigDetSums__st.html">trigDetSums_st</a>* zfit = (<a class="code" href="structtrigDetSums__st.html">trigDetSums_st</a>*)(table-&gt;GetArray());
00033                     
00034                     mRunNumber = zfit[0].runNumber;
00035                     mTimes = <font class="keyword">new</font> <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>[mNumEntries];
00036                     mCTBWest = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00037                     mCTBEast = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00038                     mCTBOR = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00039                     mTOFp = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00040                     mZDCWest = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00041                     mZDCEast = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00042                     mZDCX = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00043                     mMult = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries];
00044                     mL0 = <font class="keyword">new</font> <font class="keywordtype">double</font>[mNumEntries]; 
00045                     
00046                     <font class="keywordflow">for</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i = 0;i &lt; mNumEntries;i++){
00047                         mTimes[i] = zfit[i].timeOffset;
00048                         mCTBWest[i] = zfit[i].ctbWest;
00049                         mCTBEast[i] = zfit[i].ctbEast;
00050                         mCTBOR[i] = zfit[i].ctbOR;
00051                         mTOFp[i] = zfit[i].ctbTOFp;
00052                         mZDCWest[i] = zfit[i].zdcWest;
00053                         mZDCEast[i] = zfit[i].zdcEast;
00054                         mZDCX[i] = zfit[i].zdcX;
00055                         mMult[i] = zfit[i].mult;
00056                         mL0[i] = zfit[i].L0;
00057                     }
00058                 }
00059             }
00060         }
00061     }
00062 };
00063 <font class="comment"></font>
00064 <font class="comment">/// Delete all the arrays</font>
<a name="l00065"></a><a class="code" href="classStDetectorDbRichScalers.html#a1">00065</a> <font class="comment"></font><a class="code" href="classStDetectorDbRichScalers.html#a1">StDetectorDbRichScalers::~StDetectorDbRichScalers</a>()<font class="keyword"></font>{
00066     
00067     <font class="keyword">delete</font> mTimes;
00068     <font class="keyword">delete</font> mCTBWest;
00069     <font class="keyword">delete</font> mCTBEast;
00070     <font class="keyword">delete</font> mCTBOR;
00071     <font class="keyword">delete</font> mTOFp;
00072     <font class="keyword">delete</font> mZDCWest;
00073     <font class="keyword">delete</font> mZDCEast;
00074     <font class="keyword">delete</font> mZDCX;
00075     <font class="keyword">delete</font> mMult;
00076     <font class="keyword">delete</font> mL0;
00077 
00078 };
00079 <font class="comment"></font>
00080 <font class="comment">/// sets the event time</font>
<a name="l00081"></a><a class="code" href="classStDetectorDbRichScalers.html#a14">00081</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a14">StDetectorDbRichScalers::setEventTime</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> value)<font class="keyword"></font>{ mEventTime = value;};
00082 <font class="comment"></font>
00083 <font class="comment">/// sets the run number</font>
<a name="l00084"></a><a class="code" href="classStDetectorDbRichScalers.html#a2">00084</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a2">StDetectorDbRichScalers::setRunNumber</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> value)<font class="keyword"></font>{ mRunNumber = value;};
00085 <font class="comment"></font>
00086 <font class="comment">/// sets the number of entries in the class (must be done because using static arrays</font>
<a name="l00087"></a><a class="code" href="classStDetectorDbRichScalers.html#a3">00087</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a3">StDetectorDbRichScalers::setNumEntries</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> value)<font class="keyword"></font>{ mNumEntries = value;};
00088 <font class="comment"></font>
00089 <font class="comment">/// Fills the time arrays</font>
<a name="l00090"></a><a class="code" href="classStDetectorDbRichScalers.html#a4">00090</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a4">StDetectorDbRichScalers::setTimes</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font>* value)<font class="keyword"></font>{ mTimes = value;};
00091 <font class="comment"></font>
00092 <font class="comment">/// Fills the CTB West scaler array</font>
<a name="l00093"></a><a class="code" href="classStDetectorDbRichScalers.html#a5">00093</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a5">StDetectorDbRichScalers::setCTBWest</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mCTBWest = value;};
00094 <font class="comment"></font>
00095 <font class="comment">/// Fills the CTB East scaler array</font>
<a name="l00096"></a><a class="code" href="classStDetectorDbRichScalers.html#a6">00096</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a6">StDetectorDbRichScalers::setCTBEast</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mCTBEast = value;};
00097 <font class="comment"></font>
00098 <font class="comment">/// Fills the CTB Or scaler array</font>
<a name="l00099"></a><a class="code" href="classStDetectorDbRichScalers.html#a7">00099</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a7">StDetectorDbRichScalers::setCTBOr</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mCTBOR = value;};
00100 <font class="comment"></font>
00101 <font class="comment">/// Fills the TOFp scaler array</font>
<a name="l00102"></a><a class="code" href="classStDetectorDbRichScalers.html#a8">00102</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a8">StDetectorDbRichScalers::setTOFp</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mTOFp = value;};
00103 <font class="comment"></font>
00104 <font class="comment">/// Fills the ZDC West scaler array</font>
<a name="l00105"></a><a class="code" href="classStDetectorDbRichScalers.html#a9">00105</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a9">StDetectorDbRichScalers::setZDCWest</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mZDCWest = value;};
00106 <font class="comment"></font>
00107 <font class="comment">/// Fills the ZDC East scaler array</font>
<a name="l00108"></a><a class="code" href="classStDetectorDbRichScalers.html#a10">00108</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a10">StDetectorDbRichScalers::setZDCEast</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mZDCEast = value;};
00109 <font class="comment"></font>
00110 <font class="comment">/// Fills the ZDC AND scaler array</font>
<a name="l00111"></a><a class="code" href="classStDetectorDbRichScalers.html#a11">00111</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a11">StDetectorDbRichScalers::setZDCX</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mZDCX = value;};
00112 <font class="comment"></font>
00113 <font class="comment">/// Fills the Mult scaler array</font>
<a name="l00114"></a><a class="code" href="classStDetectorDbRichScalers.html#a12">00114</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a12">StDetectorDbRichScalers::setMult</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mMult = value;};
00115 <font class="comment"></font>
00116 <font class="comment">/// Fills the L0 scaler array</font>
<a name="l00117"></a><a class="code" href="classStDetectorDbRichScalers.html#a13">00117</a> <font class="comment"></font><font class="keywordtype">void</font> <a class="code" href="classStDetectorDbRichScalers.html#a13">StDetectorDbRichScalers::setL0</a>(<font class="keywordtype">double</font>* value)<font class="keyword"></font>{mL0= value;};
00118 <font class="comment"></font>
00119 <font class="comment">/// Gets the Run Number</font>
<a name="l00120"></a><a class="code" href="classStDetectorDbRichScalers.html#a15">00120</a> <font class="comment"></font><font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> <a class="code" href="classStDetectorDbRichScalers.html#a15">StDetectorDbRichScalers::getRunNumber</a>()<font class="keyword"></font>{ <font class="keywordflow">return</font> mRunNumber;};
00121 <font class="comment"></font>
00122 <font class="comment">/// Gets the Event Time</font>
<a name="l00123"></a><a class="code" href="classStDetectorDbRichScalers.html#a17">00123</a> <font class="comment"></font><font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> <a class="code" href="classStDetectorDbRichScalers.html#a17">StDetectorDbRichScalers::getEventTime</a>()<font class="keyword"></font>{ <font class="keywordflow">return</font> mEventTime;};
00124 <font class="comment"></font>
00125 <font class="comment">/// Gets the number of entries</font>
<a name="l00126"></a><a class="code" href="classStDetectorDbRichScalers.html#a16">00126</a> <font class="comment"></font><font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> <a class="code" href="classStDetectorDbRichScalers.html#a16">StDetectorDbRichScalers::getNumEntries</a>()<font class="keyword"></font>{ <font class="keywordflow">return</font> mNumEntries;};
00127 <font class="comment"></font>
00128 <font class="comment">/// Interpolates the value of a given array bassed on the timestamp</font>
00129 <font class="comment"></font><font class="keywordtype">double</font> StDetectorDbRichScalers::interpolateValue(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time,<font class="keywordtype">double</font>* array)<font class="keyword"></font>{
00130     <font class="keywordflow">if</font>(time ==0)
00131         time = mEventTime;
00132     
00133     <a class="code" href="classStDetectorDbInterpolator.html">StDetectorDbInterpolator&lt;double&gt;</a> inter(this-&gt;getNumEntries(),mTimes,array);
00134     <font class="keywordtype">double</font> value = inter.<a class="code" href="classStDetectorDbInterpolator.html#a1">interpolate</a>(time);
00135     <font class="keywordflow">return</font> value;
00136 };<font class="comment"></font>
00137 <font class="comment">/// Interpolates the CTB West value by given timestamp</font>
<a name="l00138"></a><a class="code" href="classStDetectorDbRichScalers.html#a18">00138</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a18">StDetectorDbRichScalers::getCTBWest</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mCTBWest);};
00139 <font class="comment"></font>
00140 <font class="comment">/// Interpolates the CTB East value by given timestamp</font>
<a name="l00141"></a><a class="code" href="classStDetectorDbRichScalers.html#a19">00141</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a19">StDetectorDbRichScalers::getCTBEast</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mCTBEast);};
00142 <font class="comment"></font>
00143 <font class="comment">/// Interpolates the CTB Or value by given timestamp</font>
<a name="l00144"></a><a class="code" href="classStDetectorDbRichScalers.html#a20">00144</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a20">StDetectorDbRichScalers::getCTBOr</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mCTBOR);};
00145 <font class="comment"></font>
00146 <font class="comment">/// Interpolates the TOFp Or value by given timestamp</font>
<a name="l00147"></a><a class="code" href="classStDetectorDbRichScalers.html#a21">00147</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a21">StDetectorDbRichScalers::getTOFp</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mTOFp);};
00148 <font class="comment"></font>
00149 <font class="comment">/// Interpolates the ZDC West value by given timestamp</font>
<a name="l00150"></a><a class="code" href="classStDetectorDbRichScalers.html#a22">00150</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a22">StDetectorDbRichScalers::getZDCWest</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mZDCWest);};
00151 <font class="comment"></font>
00152 <font class="comment">/// Interpolates the ZDC East value by given timestamp</font>
<a name="l00153"></a><a class="code" href="classStDetectorDbRichScalers.html#a23">00153</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a23">StDetectorDbRichScalers::getZDCEast</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mZDCEast);};
00154 <font class="comment"></font>
00155 <font class="comment">/// Interpolates the ZDC AND value by given timestamp</font>
<a name="l00156"></a><a class="code" href="classStDetectorDbRichScalers.html#a24">00156</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a24">StDetectorDbRichScalers::getZDCX</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mZDCX);};
00157 <font class="comment"></font>
00158 <font class="comment">/// Interpolates the Mult value by given timestamp</font>
<a name="l00159"></a><a class="code" href="classStDetectorDbRichScalers.html#a25">00159</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a25">StDetectorDbRichScalers::getMult</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mMult);};
00160 <font class="comment"></font>
00161 <font class="comment">/// Interpolates the LO value by given timestamp</font>
<a name="l00162"></a><a class="code" href="classStDetectorDbRichScalers.html#a26">00162</a> <font class="comment"></font><font class="keywordtype">double</font> <a class="code" href="classStDetectorDbRichScalers.html#a26">StDetectorDbRichScalers::getL0</a>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> time)<font class="keyword"></font>{<font class="keywordflow">return</font> interpolateValue(time,mL0);};
00163 <font class="comment"></font>
00164 <font class="comment">/// outputs to ostream the entire class</font>
<a name="l00165"></a><a class="code" href="StDetectorDbRichScalers_8cxx.html#a0">00165</a> <font class="comment"></font>ostream&amp; <a class="code" href="StDetectorDbRichVoltages_8cxx.html#a0">operator&lt;&lt;</a>(ostream&amp; os, <a class="code" href="classStDetectorDbRichScalers.html">StDetectorDbRichScalers</a>&amp; v)<font class="keyword"></font>{
00166     
00167     os &lt;&lt; <font class="stringliteral">"Run "</font> &lt;&lt; v.mRunNumber &lt;&lt; <font class="stringliteral">"\t Number of Rows "</font> &lt;&lt; v.mNumEntries &lt;&lt; endl;
00168     os &lt;&lt; <font class="stringliteral">"Time"</font> &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"        CTBW"</font> &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"CTBE"</font> &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"CTBOR"</font> &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"TOFp"</font>
00169        &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"ZDCW"</font> &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"ZDCE"</font> &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"ZDCX"</font> &lt;&lt; <font class="stringliteral">"\t"</font>&lt;&lt; <font class="stringliteral">"MULT"</font> &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; <font class="stringliteral">"L0"</font> &lt;&lt; endl;
00170     
00171     <font class="keywordflow">for</font>(<font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> i=0; i &lt; v.<a class="code" href="classStDetectorDbRichScalers.html#a16">getNumEntries</a>() ; i++){
00172         os &lt;&lt; v.mTimes[i] &lt;&lt;<font class="stringliteral">"\t"</font> &lt;&lt; v.mCTBWest[i] &lt;&lt;<font class="stringliteral">"\t"</font> &lt;&lt; v.mCTBEast[i] &lt;&lt; <font class="stringliteral">"\t"</font>
00173            &lt;&lt; v.mCTBOR[i] &lt;&lt;<font class="stringliteral">"\t"</font> &lt;&lt; v.mTOFp[i]
00174            &lt;&lt;<font class="stringliteral">"\t"</font> &lt;&lt; v.mZDCWest[i] &lt;&lt;<font class="stringliteral">"\t"</font> &lt;&lt; v.mZDCEast[i]
00175            &lt;&lt;<font class="stringliteral">"\t"</font> &lt;&lt; v.mZDCX[i] &lt;&lt;<font class="stringliteral">"\t"</font> &lt;&lt; v.mMult[i] &lt;&lt; <font class="stringliteral">"\t"</font> &lt;&lt; v.mL0[i]
00176            &lt;&lt; endl;
00177     }
00178 
00179     <font class="keywordflow">return</font> os;
00180     
00181 };
</pre></div><hr><address><small>Generated at Sat Dec 1 18:45:56 2001 for StDetectorDbMaker by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.8.1 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
