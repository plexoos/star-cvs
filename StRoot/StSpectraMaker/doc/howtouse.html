<HTML>
<HEAD>
  <META NAME="GENERATOR" CONTENT="Adobe PageMill 3.0 Win">
  <TITLE>StSpectraMaker How to use</TITLE>
</HEAD>
<BODY>

<h4 align="center">How to Use StSpectraMaker</h4>
<p><u>The Basics</u></p>
<ol>
  <li> Make a working directory and cd to it</li>
  <li>cvs co StSpectraMaker</li>
  <li>get a copy of doEvents.C from $STAR/StRoot/macros/analysis</li>
  <li>edit doEvents.C, replacing StAnalysisMaker with StSpectraMaker throughout 
    this macro</li>
  <li>run a test run root4star -b 'doEvents.C(10,&quot;/star/rcf/.....)</li>
  <li>modify the control file StRoot/StSpectraMaker/analysis.dat for your own 
    project </li>
</ol>
<P><u>The analysis.dat file</u></P>
<P>This file controls which analyses are instantiated in StSpectraMaker. To change 
  the analyses, all you need to do is edit analysis.dat . For example to instantiate 
  a StTpcDeviantSpectraAnalysis for pi+, the analysis.dat file is</P>

<PRE>TpcDeviant
pi+
piplus
StRoot/StSpectraMaker/efficYPt.config


</PRE>

<P>Other analyses can be added by repeating these lines in the same file. The 
  lines in this file will change as the eventrality selection is added.</P>

<UL>
  <LI>TpcDeviant is the type of SpectraAnalysis that will be instantiated. 
    <ul>
      <li>Current options, TpcDeviant, NoPid, V0</li>
      <li>future options, TpcDedx, TpcProb, RICH,.....</li>
    </ul>
  <LI>pi+ is the official name used in StParticleDefinition. This gives the code 
    full access to mass, decay etc. 
  <LI>piplus is the base title used for all histograms. Don't use any non alphanumeric 
    characters. This title should reflect both the particle and the centrality 
    cut. 
  <LI>The file efficYPt.config will be the output from the embedding/associator 
    job and first lists the track cuts, or V0 cuts that were used in the embedding/associator 
    job. The current .config file lists the cuts nhits&gt;10 on a track or dca_primary_vertex 
    &lt; 2.0cm. The efficiency numbers are stored in a root histogram. 
  <LI>Storing track, V0 cuts with the efficiency information ensures that the 
    calculation of spectra uses the same track cuts as were used in the embedding/association 
    task. 
  <LI>The label of the efficiency histogram controls whether the abscissa is y, 
    or eta, and whether the ordinate is mt or pt. 
  <LI>The ranges and bin sizes of the spectra histograms are the same as those 
    in the efficiency histogram. 
  <LI>To change the binning, the user must generate a new efficiency histogram, 
    presumably in the final step of the association task. 
</UL>

<P><u>Output and Extracting Invariant Spectra</u>
<P>Each instantiated analysis produces a .root file named, e.g piplus.root, in 
  the working directory with a 3-D histogram. This file contains 3-D histograms 
  of raw counts, efficiency corrected counts in e.g. (y,pt,tpc_deviant). There 
  are several diagnostic histograms of the PID method, track, VO cuts etc.
<P>Extracting invariant cross-sections from the efficiency corrected 3-D histogram 
  will critically depend on the S/B of the PID variable in each phase-space bin. 
  It is expected that each user will need to refine this for each project. An 
  example cint macro projectSpectra.C loops over the (y,pt) bins and for each 
  phase-space bin, fits the tpc_deviant axis and puts the extracted signal into 
  a invariant spectrum.
</BODY>
</HTML>
