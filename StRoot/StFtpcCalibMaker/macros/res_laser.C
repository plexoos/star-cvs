// $Id: res_laser.C,v 1.2 2006/03/15 15:14:06 jcs Exp $
//
// $Log: res_laser.C,v $
// Revision 1.2  2006/03/15 15:14:06  jcs
// add lines for listing CVS update info
//

#include "iostream.h"

float calc_min(float b1,float b2)
{
  return -b1/(2*b2);
}

void res_laser()
{
  TCanvas *c1 = new TCanvas("c1","ps",200,10,700,500);
  TStyle *plain  = new TStyle("Plain","Plain Style (no colors/fill areas)");
  plain->SetTitleOffset(1.25);
  plain->SetCanvasBorderMode(0);
  plain->SetPadBorderMode(0);
  plain->SetPadColor(0);
  plain->SetCanvasColor(0);
  plain->SetTitleColor(0);
  plain->SetStatColor(0);
  plain->SetPalette(1);
  plain->SetOptStat(0000000);
  plain->SetOptFit(00000000);

  TH2F *hr = new TH2F("hr","",10,-0.5,0.5,10,0.005,0.05);
  hr->SetTitle("#sigma_{res} vs. #Delta Argon");
  hr->GetYaxis()->SetTitleOffset(1.2);
  hr->GetYaxis()->SetTitle("#sigma_{res}");
  hr->GetXaxis()->SetTitleOffset(1.2);
  hr->GetXaxis()->SetTitle("#Delta Argon");
  hr->DrawCopy(); 
  //

  //FILE *file1=fopen ("log/t0_0.9-unf_b1_s_scan.log","r");
  //FILE *file1=fopen ("log/nov_res_b0.log","r");
  //FILE *file1=fopen ("jan_res_newclf_50_b0.log","r");
  //FILE *file1=fopen ("nov_res_newclf_50_b0.log","r");
  //FILE *file1=fopen ("nov_res_newclf_50.log","r");
  //FILE *file1=fopen ("b1_50/l_jan_b1_50_4500_schraeg.log","r");
  //FILE *file1=fopen ("b-1_jan_lsec_1_typ_1.log","r");
  //FILE *file1=fopen ("l_jan_b0_50_4500_schraeg.log","r");
  //FILE *file1=fopen ("b-1_jan_lsec1_typ1.log","r");
  FILE *file1=fopen ("res.log","r");
  Int_t datab1,datab0;

  const int nhits=160;

  float resx[nhits],resy[nhits],resrad[nhits],resphi[nhits], t0[nhits], gas[nhits];
  
  float gas_temp, t0_temp, c2,rad, err, resphi_temp, resrad_temp;

  //for (int i=1;i<=nhits-1;i++)
  int i==0;
  while(!feof(file1))
    {

      datab1 = fscanf(file1,"%f %f %f %f",&t0_temp,&gas_temp,&resx,&c2);
      datab1 = fscanf(file1,"%f %f %f %f",&t0_temp,&gas_temp,&resy,&c2);
      datab1 = fscanf(file1,"%f %f %f %f",&t0_temp,&gas_temp,&resrad_temp,&c2);
      datab1 = fscanf(file1,"%f %f %f %f",&t0_temp,&gas_temp,&resphi_temp,&c2);
      datab1 = fscanf(file1,"%f %f %f %f",&t0_temp,&gas_temp,&rad,&err);
      datab1 = fscanf(file1,"%f %f %f",&t0_temp,&gas_temp,&rad);
      datab1 = fscanf(file1,"%f %f %f %f",&t0_temp,&gas_temp,&rad,&err);
      datab1 = fscanf(file1,"%f %f %f",&t0_temp,&gas_temp,&rad);
      datab1 = fscanf(file1,"%f %f %f %f",&t0_temp,&gas_temp,&rad,&err);
      datab1 = fscanf(file1,"%f %f %f",&t0_temp,&gas_temp,&rad);
      
      //cout<<t0_temp<<endl;
      //if (t0_temp!=0)
	{
	  t0[i]=t0_temp;
	  gas[i]=gas_temp;
	  resphi[i]=resphi_temp;
	  resrad[i]=resrad_temp;
	  cout<<i<<" "<<gas_temp<<" "<<gas[i]<<" "<<resrad[i]<<endl;
	  i++;
	}
    }

  TF1 *g=new TF1("g","[0]+[1]*x^2",0,0.6);
  g->SetParameters(0.01,0.001);
  g->SetLineColor(2);

  TGraph *gerad = new TGraph(nhits,gas,resphi);
  gerad->SetMarkerStyle(22);
  gerad->SetMarkerColor(2);
  gerad->SetMarkerSize(1);
  gerad->Draw("P"); 
  //gerad->Fit(g,"R");

  //cout<<"Min phi = "<<calc_min(g->GetParameter(0),g->GetParameter(1))<<endl;

  TGraph *gerad1 = new TGraph(nhits,gas,resrad);
  gerad1->SetMarkerStyle(23);
  gerad1->SetMarkerColor(3);
  gerad1->SetMarkerSize(1);
  gerad1->Draw("P"); 
   
  g->SetLineColor(3);
  //gerad1->Fit(g,"R");

  //cout<<"Min rad = "<<calc_min(g->GetParameter(0),g->GetParameter(1))<<endl;

  leg = new TLegend(0.46,0.72,0.72,0.86); 
  leg->SetTextSize(0.05);
  leg->AddEntry(gerad,"#sigma_{res,#phi}","P");
  leg->AddEntry(gerad1,"#sigma_{res,r}","P");
  //leg->AddEntry(gerad2,"scope","P");
  //leg->AddEntry(gerad1,"52.25/47.75 halffield","P");
  //leg->AddEntry(gerad2,"53/47 halffield","P");
  //leg->AddEntry(steppurgegasno,"purge modus fieldoff 53%/47%","l");
  leg->SetFillColor(0);
  leg->Draw();

  c1->Update();

}
