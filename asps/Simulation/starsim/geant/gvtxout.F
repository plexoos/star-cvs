*
* $Id: gvtxout.F,v 1.1.1.1 2004/01/12 23:49:41 potekhin Exp $
* $Name:  $
* $Log: gvtxout.F,v $
* Revision 1.1.1.1  2004/01/12 23:49:41  potekhin
*
* Revision 1.1  2002/11/26 00:44:19  nevski
* new utility to access daughther list
*
*
#include <commons/config.h>
*
      SUBROUTINE GVTXOUT(IVERT, Length, IGENER, Ngener)
C.
C.    ******************************************************************
C.    *                                                                *
C.    *       For the vertex number IVERT (input) returns the number   *
C.    *       NGENER of the kine tracks generated by the vertex and    *
C.    *       a list IGENER of these tracks                            *
C.    *       The length of the returned list will not exeed LENGTH    *
C.    *       (which should be the length of the IGENER array)         *
C.    *                                                                *
C.    *       Author   G. Stavropoulos  *********                      *
C.    *                                                                *
C.    ******************************************************************
C.
#include "commons/typing.inc"
#include "geant321/gcbank.inc"
#include "geant321/gcnum.inc"
#include "geant321/gcunit.inc"
C
      INTEGER IVERT, LENGTH, NGENER, IGENER(*)
      INTEGER JV,NG,L,I
C.
C.    ------------------------------------------------------------------
C.
      NGENER = 0
      IF (IVERT.LT.1 .OR. IVERT.GT.NVERTX)GO TO 99
      IF (JVERTX.LE.0)GO TO 99
C
      JV=LQ(JVERTX-IVERT)
      IF (JV.GT.0)THEN
         NG=Q(JV+7)+7
         DO L=8,NG
           NGENER = NGENER + 1
           I = min(Ngener,Length)
           IGENER(i) = Q(JV+L)
         ENDDO
      ENDIF
C
  99  RETURN
      END

