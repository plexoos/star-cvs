* $Id: guhadr.age,v 1.2 2011/12/21 17:45:05 fisyak Exp $
* $Log: guhadr.age,v $
* Revision 1.2  2011/12/21 17:45:05  fisyak
* Use ipart%100 for interface with geisha,fluka and gcalor
*
* Revision 1.1.1.1  2004/01/12 23:49:38  potekhin
*
*
* Revision 1.3  2003/10/17 11:31:29  nevski
* protect hadronic packages from non-standard particle codes
*
* Revision 1.2  2003/10/13 16:08:32  nevski
* protect against non-GEANT Ipart
*
* Revision 1.1  2001/02/27 10:14:51  nevski
*  first working release
*
****************************************************************************
                SUBROUTINE   G U H A D R
* Description:  select hadronic package according to IHADR switch          *
****************************************************************************
#include "commons/typing.inc"
#include "geant321/gcflag.inc"
#include "geant321/gcphys.inc"
#include "geant321/gctrak.inc"
#include "geant321/gckine.inc"
#include "geant321/gcking.inc"
     integer CsADDR,idevt0/-1/,address/0/, Ipartsv
*
     If (Idevt0 != Idevt) then
        Idevt0  = Idevt
        address = CsADDR ('AGUHADR')
     endif
*
     IF  IHADR==0  { ISTOP=2; KCASE=NAMEC(12); DESTEP+=GEKIN; Return}
     Ipartsv = Ipart
     Ipart   = mod(Ipartsv,100)
     if (Ipart<48) then
         IF     IHADR<=3  { CALL GHEISH }
        ELSE IF IHADR==4  { CALL FLUFIN }
        ELSE IF IHADR==5  { CALL GFMFIN }
        ELSE IF IHADR==6  { CALL GCALOR }
     endif
     Ipart = Ipartsv	
*
     if (address!=0) CALL CsJCAL (address,0, 0,0,0,0,0, 0,0,0,0,0)
*
      END


