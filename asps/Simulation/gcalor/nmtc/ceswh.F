* $Id: ceswh.F,v 1.1.1.1 2004/01/15 00:08:49 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE CESWH
C** ELASTIC SCATTERING WITH HYDROGEN,
C*  STRUCK PARTICLE AT REST.
#include "gcalor/cbert.inc"
      SAVE
C
      CALL CAAZIO(SOPC,SOPS)
      PM(4) = DNCMS
      PT(1) = 0.
      DO 10 I=3,13
   10 PT(I) = 0.
      DO 20 I=15,48
   20 PT(I) = 0.
      DO 30 I=1,24
   30 COL(I) = 0.
      A=PM(4)*PM(4)
      COL(1)=E(1)+E(2)
C     TOTAL ENERGY PARTICLES 1 AND 2
      DO40 I=1,3
   40 COL(I+1)=PM(I)*PM(I)
C     MASS PARTICLE I SQD.
      COL(5)=COL(3)+COL(2)+2.0*(E(1)*E(2)-(PXYZ(1)*PXYZ(2)+PXYZ(5)*
     1PXYZ(6)+PXYZ(9)*PXYZ(10)))
      COL(6)=DSQRT(COL(5))
      COL(7)=COL(6)/COL(1)
C     GAM
      COL(8)=2.0*COL(6)
      COL(9)=(COL(4)+COL(5)-A)/COL(8)
      COM2 = COL(9)*COL(9)
   50 COL(10)=DSQRT(COM2-COL(4))
C     P3 PRIME
      COL(18)=PXYZ(9)*PM(2)/COL(6)
C     P(1),Z *M2/M=P(BAR PRIME)1,Z
      COL(21)=PXYZ(9)/COL(1)
C     VZ VELOCITY
      PXYZ(3)=COL(10)*SNT*SOPC
C     X COMPONENT P3 BAR =P3 PRIME X SIN THETA X COS PHI
      PXYZ(7)=COL(10)*SNT*SOPS
C     Y COMP. P3 BAR =P3 PRIME X SIN THETA X SIN PHI
      PXYZ(11)=COL(10)*CST
      Z=PXYZ(9)/COL(6)
      PXYZ(11)=PXYZ(11)+(Z*PXYZ(9)*PXYZ(11))/(COL(1)+COL(6))+Z*COL(9)
C     Z COMP. P3 BAR=P3 PRIME COS THETA+(P1Z SQ*P3Z (PRIME)COS
C     THETA/(E PRIME*(E+E PRIME))+P1Z*E3 PRIME/E PRIME
      E(3)=DSQRT(PXYZ(3)*PXYZ(3)+PXYZ(7)*PXYZ(7)+PXYZ(11)*PXYZ(11)+
     1PM(3)*PM(3))
      DO60 I=1,9,4
   60 PXYZ(I+3)=PXYZ(I)-PXYZ(I+2)
      E(4)=DSQRT(PXYZ(4)*PXYZ(4)+PXYZ(8)*PXYZ(8)+PXYZ(12)*PXYZ(12)
     1+PM(4)*PM(4))
C** KINETIC ENERGY OF 3 AND 4
      PT(3) = (E(3) - PM(3))/RCPMV
      PT(15) = (E(4) - PM(4))/RCPMV
C** MOMENTUM OF 3 AND 4, IN LAB.
      P3 = DSQRT(PXYZ(3)*PXYZ(3) + PXYZ(7)*PXYZ(7) + PXYZ(11)*PXYZ(11))
      P4 = DSQRT(PXYZ(4)*PXYZ(4) + PXYZ(8)*PXYZ(8) + PXYZ(12) *PXYZ(12))
C** DIRECT COSINES OF 3 AND 4
      PT(8) = PXYZ(3)/P3
      PT(9) = PXYZ(7)/P3
      PT(10) = PXYZ(11)/P3
      PT(20) = PXYZ(4)/P4
      PT(21) = PXYZ(8)/P4
      PT(22) = PXYZ(12) /P4
      RETURN
      END
