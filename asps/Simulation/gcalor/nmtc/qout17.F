* $Id: qout17.F,v 1.1.1.1 2004/01/15 00:08:49 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE QOUT17(T,B,R,W,G)
      IMPLICIT REAL *8  (A-H,O-Z)
C
#include "geant321/crandm.inc"
#include "gcalor/cbert3.inc"
#include "gcalor/cisob2.inc"
C
      DIMENSIONT(117),B(101),R(117),W(234),G(234)
      SAVE
C
      IF(I3)10  ,10  ,160
   10 PT(38)=0.0
C     1-ALPHA  PART.6+1
      VALUE1=RLKE-180.0
      CALL QRDET(1,T(1),VALUE1)
   20 COM2=CRDT(1)
      FTR =DNCMS*RLKE*2.0*RCPMV+2.9877156E27
C     E**2=MIN**2+NCNMS*RLKE*2*RCPMV
      UNIVER=DSQRT(FTR )
C     E
   30 VALUE2 = RANDC(ISEED)
      COM=VALUE2*COM2
C     R-PRIME
      CALL CQENE (B(1))
      COM1=(COM*COM+FTR -.501264E26)/(2.0*UNIVER)
C     M1R PRIME)**2+E**2-2(PNMS)/2E=E ALPHA
      A=COM1*COM1-COM*COM
      IF(A)40  ,50  ,50
   40 PACNT=PACNT+1.0
      GOTO30
   50 UNIVE=(UNIVER-COM1)*COM1*(DSQRT(A)/UNIVER)
C     ((E BETA*E ALPHA*P ALPHA)/E)=F(M,TR)
      CALL QRDET(1,R(1),VALUE1)
C     (PI-NUC)FMAX(RLKE)ISOBAR SAMPLING S.P.
      COM1 = RANDC(ISEED)
      IF((UNIVE/CRDT(1))-COM1)30  ,60  ,60
C     RANDOM NO. LESS OR EQUAL THAN F(M,TR)/FMAX(TR)
   60 CALL CQNGID
      PM(4)=POMS
      PM(3)=COM
      PT(2)=3.0
      PT(4)=POMS
      PT(14)=3.0
      PT(16)=POMS
      PT(26)=1.0
      PT(28)=DNCMS
      IF(ISW(9))80  ,70  ,80
   70 IF(ISW(10))120 ,110 ,120
   80 IF(ISW(10))130 ,90 ,130
   90 I3=-1
  100 RETURN
  110 VALUE1=.4
      VALUE2=.66666667
      VALUE3=0.0
      GOTO150
  120 CALL QRDET(2,W(1),VALUE1)
C     (PICH-P)FRACT. FIN.STA.WITH RECL. PI1 PI0 L.E.
      VALUE3=.33333333
      GOTO140
  130 CALL QRDET(2,G(1),VALUE1)
      VALUE3=STRKP
C     (PIN-P)FRACT.FIN.STA.WITH RECL.PI1 PIO L.E.
  140 VALUE1=CRDT(1)
      VALUE2=CRDT(2)
  150 CALL CQLPHA
  160 PT(3)=0.0
      PT(15)=0.0
      PT(27)=0.0
      PT(39)=0.0
  170 CALL CQOLL
      IF(COL(15))90 ,180 ,90
  180 IF(PT(38))190 ,200 ,190
  190 I3=0
      GOTO100
  200 PT(39)=0.0
      IF(IK)210 ,220 ,210
  210 PT(3)=((E(4)-PM(4))/RCPMV)+PT(3)
  220 I3=1
      GOTO100
      END
