* $Id: cqoll.F,v 1.1.1.1 2004/01/15 00:08:49 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE CQOLL
      IMPLICIT REAL *8  (A-H,O-Z)
#include "gcalor/cbert3.inc"
#include "gcalor/cisob2.inc"
      SAVE
C
      A=PM(4)*PM(4)
      COL(15)=0.0
      COL(1)=E(1)+E(2)
C     TOTAL ENERGY PARTICLES 1 AND 2
      DO10 I=1,3
   10 COL(I+1)=PM(I)*PM(I)
C     MASS PARTICLE I SQD.
      COL(5)=COL(3)+COL(2)+2.0*(E(1)*E(2)-(PXYZ(1)*PXYZ(2)+PXYZ(5)*
     1PXYZ(6)+PXYZ(9)*PXYZ(10)))
      COL(6)=DSQRT(COL(5))
      COL(7)=COL(6)/COL(1)
C     GAM
      COL(8)=2.0*COL(6)
      COL(9)=(COL(4)+COL(5)-A)/COL(8)
      COM2=COL(9)*COL(9)
   20 IF(COL(4)-2.9882156E27)30,30,50
C GT,PM(3)=ISOBAR--LTE,TEST FOR ROUNDOFF RANGE,(MIN)SQD+OR-5E23
   30 IF(COL(4)-2.9872156E27)60,40 ,40
C     LT,PION OR NUCLEON MASS=PM(3)
   40 COL(4)=2.9877156E27
      PM(3) = 5.466005D13
   50 IF(COM2-COL(4))70,90,90
   60 IF(COL(4)-SQNM)50,50,120
C     LTE,HAVE NUCLEON OR PION--GT,GO TO ERROR
   70 IF(COM2-9.9D-1*COL(4)) 90,80,80
   80 COM2 = COL(4)
      COL(9) = PM(3)
   90 COL(10)=DSQRT(COM2-COL(4))
C     P3 PRIME
      IF(IK)100,170,100
  100 COL(11)=(COL(5)+COL(2)-COL(3))/COL(8)
C     E1 PRIME
      COL(12)=DSQRT(COL(11)*COL(11)-COL(2))
C     P1 PRIME
      COL(13)=(COL(7)*E(1)-COL(11))/COL(12)
C     BETA
      COM=1.0-(COL(13)*COL(13)+COL(7)*COL(7))
      IF(COM-5.0E-6)110,150,150
  110 IF(COM+5.0E-6)120,140,140
  120 COL(15)=1.0
C     ERROR
  130 RETURN
  140 COL(14)=.002236067977
      GOTO160
  150 COL(14)=DSQRT(COM)
C     ALPHA
  160 E(3)=(COL(9)+COL(10)*(COL(13)*CST+COL(14)*SOPC*SNT))/COL(7)
      E(4)=COL(1)-E(3)
      GOTO130
  170 DO180 I=11,14
  180 COL(I)=0.0
      E(3)=0.0
      E(4)=0.0
      GOTO130
C     FOR PART AT REST E1 AND P1 PRIME,ALPHA AND BETA NOT
C     CALCULATED. E(3) ANDE(4) DONE LATER
      END
