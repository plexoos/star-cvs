* $Id: cacoll.F,v 1.1.1.1 2004/01/15 00:08:45 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE CACOLL(M)
      SAVE
#include "gcalor/cbert.inc"
      IF(M)10,20,20
   10 A=PM(4)*PM(4)
      GOTO30
   20 A=SQNM
   30 COL(15)=0.0
      MED=CLSM
      ECO (1)=CFEPN(MED)
      ECO (2)=CFEPN(MED+3)
C     PROTON(NEUTRON) ENERGY CUT-OFF
      COL(1)=E(1)+E(2)
C     TOTAL ENERGY PARTICLES 1 AND 2
      DO40 I=1,3
   40 COL(I+1)=PM(I)*PM(I)
C     MASS PARTICLE I SQD.
      COL(5)=COL(3)+COL(2)+2.0*(E(1)*E(2)-(PXYZ(1)*PXYZ(2)+PXYZ(5)*
     1PXYZ(6)+PXYZ(9)*PXYZ(10)))
      COL(6)=DSQRT(COL(5))
      COL(7)=COL(6)/COL(1)
C     GAM
      COL(8)=2.0*COL(6)
      COL(9)=(COL(4)+COL(5)-A)/COL(8)
      COM2=COL(9)*COL(9)
   50 IF(COL(4)-2.9882156D27)60,60,80
C     GT,PM(3)=ISOBAR--LTE,TEST FOR ROUNDOFF RANGE,(MIN)SQD+OR-5D23
   60 IF(COL(4)-2.9872156D27)90,70 ,70
C     LT,PION OR NUCLEON MASS=PM(3)
   70 COL(4)=2.9877156D27
      PM(3) = 5.466005D13
   80 IF(COM2-COL(4))100,120,120
   90 IF(COL(4) - SQNM) 80,80,140
C     LTE,HAVE NUCLEON OR PION--GT,GO TO ERROR
  100 IF(COM2 - 9.9D-1 * COL(4)) 120,110,110
  110 COM2 = COL(4)
      COL(9) = PM(3)
  120 COL(10)=DSQRT(COM2-COL(4))
C     P3 PRIME
      COL(11)=(COL(5)+COL(2)-COL(3))/COL(8)
C     E1 PRIME
      COL(12)=DSQRT(COL(11)*COL(11)-COL(2))
C     P1 PRIME
      COL(13)=(COL(7)*E(1)-COL(11))/COL(12)
C     BETA
      COM=1.0-(COL(13)*COL(13)+COL(7)*COL(7))
      IF(COM-5.0D-6)130,170,170
  130 IF(COM+5.0D-6)140,160,160
  140 COL(15)=1.0
C     ERROR
  150 RETURN
  160 COL(14)=2.236067977D-3
      GOTO180
  170 COL(14)=DSQRT(COM)
C     ALPHA
  180 E(3)=(COL(9)+COL(10)*(COL(13)*CST+COL(14)*SOPC*SNT))/COL(7)
      E(4)=COL(1)-E(3)
      GOTO150
      END
