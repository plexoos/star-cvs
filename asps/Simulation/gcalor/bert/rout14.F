* $Id: rout14.F,v 1.1.1.1 2004/01/15 00:08:46 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE ROUT14
      SAVE
C
#include "gcalor/cbert.inc"
#include "gcalor/crun.inc"
C
      IF(I3)310,270,10
   10 IF(I1)20 ,80 ,80
   20 I1=0
      VALUE1=(E(3)-PM(3))/RCPMV
      IF(XABS)30 ,40 ,30
   30 VALUE1=VALUE1+ABSEC
   40 IF(PT(2)-2.0)70 ,50 ,80
C     PT(2)=1=PROTON   PT(2)=2=NEUTRON   PT(2)=3,4,5=PION
   50 I3=2
   60 GO TO 320
   70 I3=1
      GOTO60
   80 CALLPINST
      IF(I1)90 ,100,90
   90 I3=3
      GOTO60
  100 I1=0
      M=PT(2)
      VALUE2=VALUE1
      IF(M-3)110,150,150
  110 IF(ECO(M)-VALUE2)140,120,130
  120 IF(ECO(M))90 ,90 ,130
  130 PT(I1+3)=0.0
      PNBC(M)=PNBC(M)+1.0
      GOTO230
  140 PT(I1+3)=VALUE2
      IF(I1)300,240,300
  150 CCOFE=CLCFE
      IF(M-4)160,170,170
  160 IF(STRKP+2.0)200,190,200
  170 IF(STRKP+2.0)200,200,180
  180 CCOFE=CLCFE-CTOFE+CTOFEN
      GOTO200
  190 CCOFE=CLCFE+CTOFE-CTOFEN
  200 IF(VALUE2-CCOFE)130,130,210
  210 IF(STRKP+2.0)220,220,140
  220 PT(3)=VALUE1-SPACE(MED+3)+SPACE(MED+9)
  230 IF(I1)260,240,260
  240 M=PT(14)
      IF(M-3)250,90 ,90
  250 VALUE2=COM
      I1=12
      GOTO110
  260 IF(PT(3))300,270,300
  270 CALLCAPUNP
      IF(I1)90 ,280 ,290
C     -, =ERROR  0=END OF RECORD  +=PISCC(6607)
  280 I3=4
      GOTO60
  290 I3=5
      GOTO60
  300 CALL COLLM(-1)
  310 IF(KE.GT.0)GO TO 320
      CALL CASTPR
      IF(I1)90 ,270,90
  320 RETURN
      END
