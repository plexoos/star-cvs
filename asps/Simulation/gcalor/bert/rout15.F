* $Id: rout15.F,v 1.1.1.1 2004/01/15 00:08:46 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE ROUT15(T)
      SAVE
      REAL*8 T(6426)
#include "gcalor/cbert.inc"
#include "geant321/crandm.inc"
C
      GOTO(10 ,80 ,20 ,100),I3
   10 IF(RLKE.LE.2.5D3) GO TO 40
   20 I3=4
   30 GO TO 160
   40 IF(IK-3)70 ,50 ,60
   50 I3=1
      GOTO30
   60 I3=2
      GOTO30
   70 CALL CALMUD(SNT,INPT)
      CALL CRDET(51,T(1),RLKE)
      I2 = 0
      CST = CRDT(2) - DABS(SNT*(CRDT(2) - CRDT(1)))
   80 IF(I2)90 ,90 ,20
   90 I3=3
      GOTO30
  100 VALUE1 = RANDC(ISEED)
      IF(VALUE1-CRDT(1))150,110,110
  110 VALUE2=1.0
C     SCATT. FORWARD
      VALUE1= RANDC(ISEED)
      IF(VALUE1-CRDT(4))120,140,140
  120 VALUE1 = RANDC(ISEED)
C     TO SAMPLE FROM UNIFORM DIST.
  130 CST=VALUE1*VALUE2
      GOTO90
  140 COM=0.0
      CALL CABIG7(COM,VALUE1,I1)
      GOTO130
  150 VALUE2=-1.0
      VALUE1 = RANDC(ISEED)
      I1=I1+I2
      IF(VALUE1-CRDT(2))120,140,140
  160 RETURN
      END
