* $Id: rout22.F,v 1.1.1.1 2004/01/15 00:08:46 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE ROUT22(V,W,X,Y,Z)
      REAL*8 V(19),W(19),X(126),Y(126),Z(126)
#include "gcalor/cbert.inc"
      SAVE
C
      I5=CURR(1)
      GOTO(270 ,1070,340 ,350 ,370 ,1040,520 ,1110,1170,460 ,1270,440 ,4
     +00  ,500 ,1440,10  ,700 ,590 ,260 ,530 ,430 ,1220,1570),IV
   10 DO20  I=1,3
         XI(I)=CURR(I+3)
   20 DCOS(I)=CURR(I+6)
      IN=-1
      MED=CURR(10)
      I5=CURR(1)
      CALL CALGEO
      IF(I1)60  ,30  ,30
   30 IF(CURR(1)-2.0)70  ,680 ,40
   40 IF(CURR(1)-4.0)690 ,700 ,50
   50 IV=1
   60 RETURN
   70 ISW(4)=1
C     PROTON
   80 XABS=0.0
      I4=1
      I2=MED
      IF(I2-1)110,90  ,210
   90 I4=6
      GOTO210
  100 ISW(6)=1
      ISW(5)=1
      I3=0
      IF(COM-3600.0)120 ,120 ,110
  110 IV=2
      GOTO60
C     COM=GREATEST ENERGY INSIDE NUCLEUS FOR NUCLEONS ONLY
  120 IF(COM-560.0)130 ,130 ,140
  130 IF(COM-160.0)200 ,200 ,190
  140 CALLDFMAX
C     DFMAX FILLS OUT FMAX(1-6)
      I1=6
  150 IF(CURR(1)-2.0)170 ,160 ,160
  160 I3=1
  170 CALLCSTORE
      EX=0.0
      CALLSIGNEX
      GOTO(260 ,370 ,430 ,480 ,400 ,580 ,920 ,1040,1170,180,1440),I4
  180 IV=3
      GOTO60
  190 ISW(6)=0
      CALLPFMAX
C     PFMAX FILLS OUT FMAX(1-4)
      I1=4
      GOTO150
  200 ISW(5)=0
      ISW(6)=0
      CALLCALNNN
C     NN FILLS OUT FMAX(1-2),FMAX(3-6)=0
      I1=2
      GOTO150
  210 ISW(1)=0
      ISW(2)=0
      ISW(3)=0
  220 M=MED+ INT(15.0-6.0*SNGL(CURR(1)))
      A=CURR(2)-SPACE(M)
  230 DO240 I=1,3
         WKRPN(I)=A+SPACE(I+9)
  240 WKRPN(I+3)=A+SPACE(I+3)
  250 M=4-3*ISW(4)
      COM=WKRPN(M)
      GOTO100
  260 GOTO(1290,1290,270 ),I2
  270 IF(EX-D(2))310 ,310 ,280
C     ENTRY POINT FOR CASCADE CHARGED AND NEUTRAL PIONS AFTER CRJAB
C     REJECTION,PROD.REACTION LT 180 FERMI REJECTION FOR NON-ABSORPTION
C     REACTION ALSO ALL CASCADE NUCLEAR REJECTIONS INCLUDING CRJAB OR
C     RLKE LT PROD.THRESHOLD
  280 IF(D(3))560 ,290 ,560
  290 CALLCCPES
      IF(I1)300,300,110
C     GO TO CAPUNP
  300 IV=4
      GOTO60
  310 IF(IN) 320 ,320  ,1460
  320 CALLCBG6CA(3,0)
      IFCC=12
  330 MED=CLSM
      IV=5
      GOTO60
  340 VALUE1=EX
      IV=6
      GOTO60
  350 VALUE1=EX+D(3)
  360 IV=7
      GOTO60
C     E.P.FOR REJECTION FOLLOWING CRJAB OR RLKE LT 180 IN PROD.REACTIONS
C     AND FOR FERMI REJECTION IN SCATTERING AND PRODUCTION REACTIONS
C     FOR CASCADE CHARGED AND NEUTRAL PIONS
  370 IF(EX-D(6))310 ,310 ,290
  380 ISW(1)=1
  390 GOTO(400 ,400 ,400 ,1040),I5
C     E.P.FOR ALL REJECTIONS,CRJAB,PRODUCTION,AND FERMI FOR CASCADE
C     NUCLEONS
  400 IF(EX-D(3))510 ,510 ,410
  410 I2=3
      I4=2
      I3=1
      I1=2
      IF(D(4))420 ,250 ,420
  420 ISW(2)=1
      ISW(3)=1
      I4=3
      I2=1
      GOTO250
  430 GOTO(440 ,440 ,440 ,1170),I5
  440 IF(EX-D(4))450 ,450 ,470
  450 CALLCBG6CA(1,0)
      IFCC=7
      GOTO330
  460 VALUE1=EX
      IV=8
      GOTO60
  470 I4=4
      I1=2
      I2=2
      I3=1
      GOTO250
C     E.P.FOR CASCADE NUCLEONS AND PI0,AFTER CRJAB AND PROD.THRESHOLD
C     REJECTIONS
  480 IF(I5-2)500 ,500 ,490
  490 IF(I5-4)110,1440,110
C     E.P.FOR CASCADE NUCLEONS AFTER ALL FERMI REJECTIONS
  500 IF(EX-D(5))510 ,510 ,540
  510 CALLCBG6CA(2,0)
      IFCC=10
      GOTO330
  520 VALUE1=EX
      GOTO360
  530 IF(ISW(3))480 ,390 ,480
  540 I4=2
      I2=3
  550 I3=1
      I1=2
      GOTO250
  560 ISW(1)=1
      IF(CURR(1)-3.0)570 ,940 ,1390
  570 I4=5
      I2=2
      GOTO550
C     D.P.
  580 ISW(1)=1
      ISW(2)=1
      ISW(3)=1
      GOTO260
  590 ANY=FMAX(NOT)
      IF(NOT-5)620 ,600 ,610
  600 IV=9
      GOTO60
  610 IF(I5-4)600 ,630 ,600
  620 IF(KNOT-15)630 ,1560,1560
  630 GOTO(640 ,640 ,640 ,1510),I5
  640 IF(NOT-2)650 ,660 ,670
  650 IV=10
      GOTO60
  660 IV=11
      GOTO60
  670 IV=12
      GOTO60
  680 ISW(4)=0
C     NEUTRON
      GOTO80
  690 ISW(11)=1
C     CURR(1)=3=PI+ MESON(11575)--PI 0=4(15100)--PI -(14646)
  700 IN=1
      ISW(1)=0
      ISW(2)=0
      ISW(3)=0
      ISW(5)=1
      ISW(6)=0
      ISW(7)=0
      ISW(8)=1
      I6=I5-2
      I2=MED
      COM=CURR(2)-SPACE(MED+9)
      GOTO(720 ,710 ,730 ),MED
C     E.P.FOR PI0 AFTER FERMI REJECTION
  710 ISW(8)=0
  720 ISW(7)=1
  730 DO740 I=1,3
         WKRPN(I)=COM+SPACE(I+9)
  740 WKRPN(I+3)=COM+SPACE(I+3)
      COM=COM+SPACE(4)
  750 IF(COM-2600.0)760 ,760 ,110
  760 IF(COM-100.0)770 ,770 ,780
  770 LG=4
      GOTO1330
  780 LG=6
  790 CALLCASPCN
      IF(VALUE1)800 ,800 ,830
  800 COM=CURR(2)-SPACE(MED+9)
      IF(COM-360.0)810 ,830 ,830
  810 GOTO(820 ,1350,820 ),I6
  820 CALLCRDET(1,V(1),COM)
      FMAX(4)=CRDT(1)
  830 GOTO(840 ,1360,840 ),I6
  840 I1=6
  850 I4=7
      I2=1
      I3=0
      GOTO(860 ,870 ,860 ),I6
  860 IF(ISW(11))870 ,910 ,870
C     PI+
  870 IF(ISW(7))880 ,900 ,880
C     PI-
  880 IF(ISW(8))170 ,890 ,170
  890 I2=2
      GOTO170
  900 I2=3
      GOTO170
  910 I3=1
      GOTO870
  920 IF(CURR(1)-2.0)930 ,930 ,260
  930 A=CURR(2)-SPACE(MED+9)
      GOTO230
  940 I4=8
  950 I2=2
  960 I3=0
      I1=LG
      IF(CURR(1)-4.0)970 ,1030,970
  970 IF(ISW(11))990 ,980 ,990
  980 I3=1
  990 IF(CURR(1)-3.0)1000,1010,1010
 1000 IV=23
      GOTO60
 1010 IF(LG-4)1000,170 ,1020
 1020 M=5-IABS(I5-4)
      UNIVER=FMAX(M)
      CALLCASPCN
      FMAX(M)=UNIVER
      GOTO170
 1030 I1=I1+1
      GOTO1010
C     E.P.FOR CHARGED AND NEUTRAL PIONS AFTER CRJAB REJECTION ALSO,AFTER
C     RLKE.LE.180 IN PROD.REACTIONS AND AFTER FERMI REJECTION IN SCATTER
C     ING AND PROD.REACTIONS
 1040 IF(EX-D(3))1050,1050,1140
 1050 GOTO(1060,1410,1060),I6
 1060 IV=13
      GOTO60
 1070 ANY=FMAX(NOT)
      IF(CURR(1)-3.0)1080,1100,1100
 1080 IFC=12
 1090 IV=14
      GOTO60
 1100 IFCC=(CLSM-2.0)*((CLSM*5.5)-8.5)+12.05
      GOTO1090
 1110 IF(I4-10)1120,1210,1120
C     E.P.FOR ESCAPE PRIOR TO CHOOSING REACTIONS--CASCADE CHARGED PION
 1120 IF(CLSM-2.0)1130,1210,1130
 1130 I4=2
      GOTO950
 1140 I4=2
C     E.P.WHEN CASCADE PARTICLE ESCAPES FROM REGION 2
      I2=3
      IF(D(4))1160,1150,1160
 1150 GOTO(960 ,1450,960 ),I6
 1160 ISW(2)=1
      ISW(3)=1
      I4=9
      I2=1
      GOTO1150
C     E.P.AFTER ALL REJECTIONS EXCEPT FERMI IN ABS.REACTIONS FOR
C     CHARGED AND NEUTRAL CC PIONS--ESCAPE FROM REGION 1 PRIOR TO
C     CHOOSING REACTION FOR CC CHARGED PION
 1170 IF(EX-D(4))1180,1180,1200
 1180 GOTO(1190,1480,1190),I6
 1190 IV=15
      GOTO60
 1200 I4=10
      GOTO(950 ,1430,950 ),I6
 1210 I4=2
      I2=3
      GOTO960
 1220 IF(IN)1240,1230,1240
 1230 IV=16
      GOTO60
 1240 IFCA=8*IABS(I6-2)-11*(I6-1)*(I6-3)
      IF(ISW(1))1250,340 ,1250
 1250 IF(ISW(2))1260,350,1260
 1260 IV=17
      GOTO60
 1270 IFCA=10*IABS(I6-2)+12*(I6-1)*(3-I6)
      IF(ISW(3))1280,520,1280
 1280 IV=18
      GOTO60
 1290 IF(CURR(1)-3.0)1300,1310,1310
 1300 GOTO(430 ,380 ),MED
 1310 ISW(1)=1
      GOTO(1320,1040),MED
 1320 ISW(2)=1
      ISW(3)=1
      GOTO1170
 1330 ISW(5)=0
      GOTO(1340,1500,1340),I6
 1340 CALLCBOVER(CURR(2),PNMS,ANS)
      FMAX(1)=.20 D-24*ANS
C     (PI+P)SCATTERING
      FMAX(2) = 23.0D-27*ANS
C     (PIM+P)SCATTERING
      FMAX(3)=45.1D-27*ANS
C     (PIM+P)EXCHANGE
      COM=CURR(2)-SPACE(MED+9)
C     (K.E.OF PIONS OUTSIDE NUCLEUS
      CALLCRDET(1,V(1),COM)
      FMAX(4)=CRDT(1)
C     C(PIP+P)ABS.
      I1=4
      GOTO850
 1350 CALLCRDET(1,W(1),COM)
      FMAX(5)=CRDT(1)
 1360 I1=7
      GOTO850
 1370 CALLCBG6CA(3,4)
      IFCC=24
 1380 KA=7
      MED=CLSM
      IV=19
      GOTO60
 1390 I4=8
 1400 I2=2
      GOTO960
 1410 CALLCBG6CA(2,3)
 1420 IFCC=21
      GOTO1380
 1430 I4=11
      GOTO1400
 1440 IF(EX-D(5))1410,1410,1490
 1450 I1=9-I5
      GOTO960
 1460 GOTO(1470,1370,1470),I6
 1470 IV=20
      GOTO60
 1480 CALLCBG6CA(1,2)
      GOTO1420
 1490 I1=5
      GOTO1210
 1500 CALLCBOVER(CURR(2),POMS,ANS)
      FMAX(1) = 89.2D-27*ANS
C     (PI0+P)ELAST.SCAT.
      FMAX(2)=45.1D-27*ANS
C     (PI0+P)EX.SCAT.
      FMAX(3)=FMAX(1)
      SPACE(48)=FMAX(1)
      FMAX(4)=FMAX(2)
      SPACE(49)=FMAX(2)
      COM=CURR(2)-SPACE(MED+9)
      CALLCRDET(1,W(1),COM)
C     (PIN-P)ABS. CRS.SEC.
      FMAX(5)=CRDT(1)
C     (PI0+P)ABS.
      SPACE(50)=FMAX(5)
      I1=5
      GOTO850
 1510 IF(NOT-2)1530,1550,1520
 1520 IV=21
      GOTO60
 1530 CALLCRJAB(1,X(1))
C     (PIN-P)DIRECT SCAT.CRS.
 1540 IV=22
      GOTO60
 1550 CALLCRJAB(1,Y(1))
C     (PIM-P)XCH.SCAT.CRS.
      GOTO1540
 1560 IF(KNOT-16)1570,1550,1550
 1570 CALLCRJAB(1,Z(1))
C     (PIN-N)DRCT.SCAT.CRS.
      GOTO1540
      END
