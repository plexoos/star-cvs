* $Id: calidk.F,v 1.1.1.1 2004/01/15 00:08:45 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE CALIDK
#include "gcalor/cbert.inc"
      SAVE
C
      UNIV=PNIDK(6)*PNIDK(6)
C     M(P1) SQUARED  DECAY PION MASS SQUARED
      PNIDK(7)=(PNIDK(1)*PNIDK(1)+UNIV-SQNM)/(2.0*PNIDK(1))
C     E(PI)PRIME  DECAY PION ENERGY PRIME
      PNIDK(8)=DSQRT(PNIDK(7)*PNIDK(7)-UNIV)
C     DECAY PION MOMENTUM PRIME  P(D)
      CALL CAPOL1(PNIDK(20),PNIDK(21))
C     COS THETA, SIN THETA
      CALL CAAZIO(PNIDK(22),PNIDK(23))
C     COS PHI, SIN PHI
      PNIDK(9)=PNIDK(22)*PNIDK(21)*PNIDK(8)
C     DECAY PION X MOMENTUM COMPONENT PRIME
      PNIDK(10)=PNIDK(21)*PNIDK(23)*PNIDK(8)
C     P(P1)PRIME Y
      PNIDK(11)=PNIDK(20)*PNIDK(8)
C     P(P1)PRIME Z
      UNIV=PNIDK(9)*PNIDK(2)+PNIDK(10)*PNIDK(3)+PNIDK(11)*PNIDK(4)
C     P P1 PRIME DOT P
      PNIDK(12)=(PNIDK(7)*PNIDK(5)+UNIV)/PNIDK(1)
C     DECAY PION ENERGY  E(PI)
      PNIDK(13)=PNIDK(5)-PNIDK(12)
      UNIV=(((PNIDK(5)/PNIDK(1))-1.0)*UNIV)/(PNIDK(2)*PNIDK(2)+
     +PNIDK(3)*PNIDK(3)+PNIDK(4)*PNIDK(4))
C     (E/M-1.0)*P(P1)PRIME DOT P/P SQUARED
      UNIVE=PNIDK(7)/PNIDK(1)
C     E PI PRIME OVER MASS
      DO10 I=2,4
         PNIDK(I+12)=PNIDK(I)*(UNIV+UNIVE) +PNIDK(I+7)
   10 PNIDK(I+15)=PNIDK(I)-PNIDK(I+12)
      RETURN
C     PION MOMENTUM COMPONENTS AND NUCLEON MOMENTUM
C     COMPONENTS
      END
