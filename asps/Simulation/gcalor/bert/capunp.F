* $Id: capunp.F,v 1.1.1.1 2004/01/15 00:08:45 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE CAPUNP
#include "gcalor/cbert.inc"
#include "gcalor/crn.inc"
#include "gcalor/cmunpu.inc"
      REAL*8 AC,ZC,AR,ZE
      SAVE
C
      IF(PGVC(1))10,60,30
   10 I1=-1
   20 RETURN
   30 PGVC(1)=PGVC(1)-11.0
      K=PGVC(1)+2.005
      DO40 I=1,11
         CURR(I)=PGVC(K)
         PGVC(K)=0.0
   40 K=K+1
   50 I1=1
      GOTO20
   60 IF(PLVC(1))10,130,70
   70 UNIV=0.0
      L=PLVC(1)
      K=-10
      DO110 I=1,L
   80    K=K+12
         IF(PLVC(K))10,80,90
   90    IF(PLVC(K)-UNIV)110,100,100
  100    UNIV=PLVC(K)
         M=K
  110 CONTINUE
      PLVC(M)=0.0
      DO120 I=1,11
         M=M+1
         CURR(I)=PLVC(M)
  120 PLVC(M)=0.0
      PLVC(1)=PLVC(1)-1.0
      GOTO50
  130 I1=0
      AC=AMASNO
      IF(NO.GT.2)GOTO140
      ZC=ZEE
      AC=AMASNO+1.0D0
C AC-COMPOUND NUC,ZC=CHG.COMPOUND,AR=MASS CASCADE RESID.NUCLEUS
      IF(NO.EQ.1)GOTO150
      GOTO160
  140 IF(NO.LT.5)GOTO150
      ZC=ZEE-1.0D0
      GOTO160
  150 ZC=ZEE+1.0D0
  160 AR=AC-COUNT(1)-COUNT(2)
      ZE=COUNT(1)+COUNT(3)-COUNT(5)
      IF(AR)170,180,190
  170 COUNT(7)=COUNT(7)+1.0D0
      GOTO210
  180 IF(ZC.EQ.ZE)GOTO20
      COUNT(8)=COUNT(8)+1.0D0
      GOTO210
  190 IF(AR.GE.(ZC-ZE))GOTO200
      COUNT(9)=COUNT(9)+1.0D0
      GOTO210
  200 IF(ZC.GE.ZE)GOTO20
      COUNT(10)=COUNT(10)+1.0D0
  210 IF(BEGRU.EQ.1.0D0)GOTO260
      BEGRU=BEGRU-1.0D0
  220 DO230 I=1,12
         CC(I)=PCC(I)
  230 IPEC(I)=NIP(I)
      DO 240 I = 1,5
  240 PNBC(I)=PPNB(I)
  250 NOR=NOR-1
      COUNT(6)=-1.0D0
      GO TO 20
  260 BEGRU=-1.0D0
      GO TO 220
C 1. PICKS UP LAST 11 ITEMS IN PGVC AND STORES
C THEM IN CURR.  STORES ZERO IN THOSE 11 PGVC CELLS.
C     GROUP IS GREATER THAN 1ST IN ALL OTHER GROUPS.  STORES
C     2-12TH ITEMS IN CURR--ZEROES ITEMS 1-12 IN PLVC GROUP.
      END
