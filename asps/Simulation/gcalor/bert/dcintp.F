* $Id: dcintp.F,v 1.1.1.1 2004/01/15 00:08:45 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE DCINTP(W)
#include "gcalor/cbert.inc"
C
#include "geant321/crandm.inc"
      REAL*8 W(250),Z(24),FLTI
      SAVE
C
      Z(1)=RLKE-6.6D2
      IE=IDINT(Z(1)/2.0D1+5.0D-6)
      UNIV=(Z(1)-DFLOAT(IE)*2.0D1)/2.0D1
      IE=IE+1
      UNIVE=(W(IE+1)-W(IE))*UNIV+W(IE)
C RATIO
      I2=0
      K=1
      UNIV = RANDC(ISEED)
      IF(UNIV.GE.UNIVE)GOTO190
C LT=BACKWARD
C N-P ELASTIC SCAT.,RLKE GT 660
      LLL=179
      IF(W(180).GT.RLKE) GO TO 20
      DO 10 I = 1,5
         IF(W(179+K).GT.RLKE)GO TO 40
   10 K=K+12
   20 I1=-1
C ERROR
   30 RETURN
   40 M=12
   50 DO60 L=1,M
         Z(L+M)=W(LLL+K)
         Z(L)=W(LLL+K-M)
   60 K=K+1
      UNIV = RANDC(ISEED)
      UNIVE=(RLKE-Z(1))/(Z(M+1)-Z(1))
      DO70 I=2,M
         P=(Z(I+M)-Z(I))*UNIVE+Z(I)
         IF(P.GE.UNIV) GO TO 80
   70 CONTINUE
      GO TO 20
   80 I1=I
      UNIV = RANDC(ISEED)
      FLTI=UNIV+DFLOAT(I1-2)
      IF(M.LE.9) GO TO 230
   90 GOTO(20,100,100,110,120,130,130,140,150,160,170,180),I1
  100 CST=1.0D-2*FLTI-0.1D1
      GO TO 30
  110 CST=2.0D-2*UNIV-9.8D-1
      GO TO 30
  120 CST=4.0D-2*UNIV-9.6D-1
      GO TO 30
  130 CST=6.0D-2*FLTI-0.116D1
      GO TO 30
  140 CST=8.0D-2*UNIV-8.0D-1
      GO TO 30
  150 CST=1.0D-1*UNIV-7.2D-1
      GO TO 30
  160 CST=1.2D-1*UNIV-6.2D-1
      GO TO 30
  170 CST=2.0D-1*UNIV-5.0D-1
      GO TO 30
  180 CST=3.0D-1*(UNIV-1.0D0)
      GO TO 30
C FORWARD
  190 LLL=143
      IF(W(144).GT.RLKE) GO TO 20
  200 DO 210 I = 1,4
         IF(W(143+K).GT.RLKE) GO TO 220
  210 K=K+9
      GOTO20
  220 M=9
      GOTO50
  230 GOTO(20,240,240,240,240,250,260,270,280),I1
  240 CST=1.0D0-2.5D-2*FLTI
      GOTO30
  250 CST=8.5D-1+0.5D-1*UNIV
      GOTO30
  260 CST=7.0D-1+1.5D-1*UNIV
      GOTO30
  270 CST=5.0D-1+2.0D-1*UNIV
      GOTO30
  280 CST=5.0D-1*UNIV
      GOTO30
      END
