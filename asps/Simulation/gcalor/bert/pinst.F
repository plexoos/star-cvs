* $Id: pinst.F,v 1.1.1.1 2004/01/15 00:08:46 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE PINST
#include "gcalor/cbert.inc"
      SAVE
C
      I1=0
      MED=CLSM
      IF(INC)10,140,10
   10 INC=0
      IF(MED-1)20,50,40
   20 I1=1
   30 RETURN
   40 IF(MED-3)60,90,20
   50 IPEC(12)=IPEC(12)+1
C     INCIDENT PARTICLE ON REG.1 COLLISION IN REG.1
      GOTO30
   60 IF(D(4))80,70,80
   70 IPEC(8)=IPEC(8)+1
      GOTO30
C     INC. PARTICLE ON REG.2 COLLISION IN REG.2
   80 IPEC(9)=IPEC(9)+1
C     INC. PARTICLE ON REG.1 COLLISION IN REG.2
      GOTO30
   90 IF(D(3))100,120,100
  100 IF(D(4))110,130,110
  110 IPEC(5)=IPEC(5)+1
C     INC. PARTICLE ON REG.1 COLLISION IN REG.3
      GOTO30
  120 IPEC(3)=IPEC(3)+1
C     INC. PARTICLE ON REG.3 COLLISION IN REG.3
      GOTO30
  130 IPEC(4)=IPEC(4)+1
C     INC. PARTICLE ON REG.2 COLLISION IN REG.3
      GOTO30
  140 K=CURR(11)
      K=3*(MED-1)+K
      CC(K)=CC(K)+1.0
      GOTO30
C     COLLISION REG.1 PARTICLE ORIGIN K
      END
