* $Id: rout17.F,v 1.1.1.1 2004/01/15 00:08:46 potekhin Exp $
* $Name:  $
#include <commons/config.h>
      SUBROUTINE ROUT17(T,B,R,W,G)
C
#include "geant321/crandm.inc"
#include "gcalor/cbert.inc"
C
      REAL*8 T(117),B(101),R(117),W(234),G(234)
      SAVE
C
      IF(I3)10  ,10  ,150
   10 PT(38)=0.0
C     1-ALPHA  PART.6+1
      VALUE1=RLKE-180.0
      CALL CRDET(1,T(1),VALUE1)
      COM2=CRDT(1)
      FTR=DNCMS*RLKE*2.0*RCPMV+2.9877156D27
C     E**2=MIN**2+NCNMS*RLKE*2*RCPMV
      UNIVER=DSQRT(FTR)
C     E
   20 VALUE2 = RANDC(ISEED)
      COM=VALUE2*COM2
C     R-PRIME
      CALL CAGENE(B(1))
      COM1=(COM*COM+FTR-.501264D26)/(2.0*UNIVER)
C     M1R PRIME)**2+E**2-2(PNMS)/2E=E ALPHA
      A=COM1*COM1-COM*COM
      IF(A)30  ,40  ,40
   30 PACNT=PACNT+1.0
      GO TO 20
   40 UNIVE=((UNIVER-COM1)*COM1/UNIVER)*DSQRT(A)
C     ((E BETA*E ALPHA*P ALPHA)/E)=F(M,TR)
      CALL CRDET(1,R(1),VALUE1)
C     (PI-NUC)FMAX(RLKE)ISOBAR SAMPLING S.P.
      COM1 = RANDC(ISEED)
      IF((UNIVE/CRDT(1))-COM1)20  ,50  ,50
C     RANDOM NO. LESS OR EQUAL THAN F(M,TR)/FMAX(TR)
   50 CALLCANGID
      PM(3)=COM
      PM(4)=POMS
      PT(2)=3.0
      PT(4)=POMS
      PT(14)=3.0
      PT(16)=POMS
      PT(26)=1.0
      PT(28)=DNCMS
      IF(ISW(9))70  ,60  ,70
   60 IF(ISW(10))110 ,100 ,110
   70 IF(ISW(10))120 ,80 ,120
   80 I3=-1
   90 RETURN
  100 VALUE1=.4
      VALUE2=6.6666667D-1
      VALUE3=0.0
      GO TO 140
  110 CALL CRDET(2,W(1),VALUE1)
C     (PICH-P)FRACT. FIN.STA.WITH RECL. PI1 PI0 L.E.
      VALUE3=3.3333333D-1
      GO TO 130
  120 CALL CRDET(2,G(1),VALUE1)
      VALUE3=STRKP
C     (PIN-P)FRACT.FIN.STA.WITH RECL.PI1 PIO L.E.
  130 VALUE1=CRDT(1)
      VALUE2=CRDT(2)
  140 CALL CALPHA
  150 CALL CAECPL
      IF(I1)160 ,160 ,80
  160 CALL CACOLL(-1)
      IF(COL(15))80 ,170 ,80
  170 IF(PT(38))180 ,190 ,180
  180 I3=0
      GO TO 90
  190 PT(39)=0.0
      PT(3)=((E(4)-PM(4))/RCPMV)+PT(3)
      I3=1
      GO TO 90
      END
