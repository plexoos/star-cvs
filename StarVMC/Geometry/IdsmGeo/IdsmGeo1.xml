<Document file="StarVMC/Geometry/IdsmGeo/IdsmGeo1.xml">

<Module name="IDSMGEO1" comment=" simplified  beam support cone for 2012 "  >

   <Created date="  4/10/2011 "  />
   <Author name="Jan Balewski MIT "  />
   <CDE>AGECOM,GCUNIT,GCONST</CDE>

<!-- User defined Geant volumes -->
<Content  >
      IDSM,OSCA,WSCC,WSCD,WSCO,WSCF,WSCP,WSCB,TPRR,TPRT
</Content>

<!--                   ===============================================================================
                       new Support Cone consit of 3 cylinders w/ 2 flats and 2 disks : 


                       (simplified implementation, East= -West)


                               === East cyl ===                        ====== west cyl ====
                                               |                      |         'WSCC'=WSCO+WSCF 
                                           east disk              west disk='WSCD'=WSCP+WSCB
                                               |         'OSCA'       |
                                               ======== mid cyl =======

                                 .......................+Z axis ==> ...................

                       resistor chain volumes: TPRR,TPRT 
                       mother volume=IDS
                       ===============================================================================
-->

        
<!-- mmmmmmmmmm  local work-variables  mmmmmmmmmmmmmmm -->
<varlist type="REAL"  >
      inR, outR,lengthZ, centerZ,
      z1,z2,k,phi1,phi2,sinA, cosA, outRflat, boxR, resR, angR,m
</varlist>


<!-- mmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm 
    Create and initialize structures defining detector parameters
  mmmmmmmmmmmmmmmmmmmmmmmmmmmmmm     -->

<Structure name="IDSG" >
   <var name="version" type="float" />
   <var name="lenM" />
   <var name="rM" />
   <var name="lenW" />
   <var name="rW" />
   <var name="thick" />
   <var name="zStart" />
   <var name="angDel" />
   <var name="angFlat" />
   <var name="r1Res" />
   <var name="r2Res" />
   <var name="rrRes" />
   <var name="dangRes" />
   <var name="dxRes" />
   <var name="dyRes" />
</Structure>


<!-- Alignment of the IDSM geometry within the CAVE -->
<Structure name="IDSA">

   <var name="version" type="float" />
   <var name="x"       type="float" />
   <var name="y"       type="float" />
   <var name="z"       type="float" />

   <var name="thetax"  type="float" />
   <var name="thetay"  type="float" />
   <var name="thetaz"  type="float" />

   <var name="phix"    type="float" />
   <var name="phiy"    type="float" />
   <var name="phiz"    type="float" />

</Structure>


<Fill name="IDSG" comment="IDS Geometry data,46.1cm=inner radii of IFC"  >

   <var name="version" value="1.0"     comment="Versioning of the IDS geometry" />

   <var name="zStart" value="0." comment=" Z position of middle cone"  />
   <var name="thick" value="0.3" comment=" thickens of any element"  />
 
   <var name="lenM" value="100." comment="Z length of  middle cone"  />
   <var name="rM" value="6." comment=" radii of middle cone"  />

   <var name="lenW" value="120." comment="Z lenght of west cone"  />
   <var name="rW" value="41." comment=" radii of west cone"  />
   
   <var name="angFlat" value="106." comment=" angle (deg) for center of flat"  />
   <var name="angDel" value="36." comment=" opening angle (deg) of flat"  />

   <var name="rrRes" value="44." comment=" radial distance of  for TPC resistor tubes"  />
   <var name="r1Res" value="1.17" comment=" inner radii for TPC resistor tubes"  />
   <var name="r2Res" value="1.27" comment=" outer radii for TPC resistor tubes"  />

   <var name="dangRes" value="11.3" comment=" opening angle (deg) for TPC resistor tubes"  />
   <var name="dxRes" value="0.13" comment=" thicknessfor TPC resistor"  />
   <var name="dyRes" value="2." comment=" dy for TPC resistor"  />

</Fill>


<Fill name="IDSA" comment="Alignment of the IDSM geometry within the CAVE">

   <var name="version" value="1.0"    comment="Default alignment of IDSM at (0,0,0) with no rotation" />   

   <var name="x"       value="0.0"    comment="x-alignment" />
   <var name="y"       value="0.0"    comment="y-alignment" />
   <var name="z"       value="0.0"    comment="z-alignment" />

   <var name="thetax"  value="90.0"   comment="align x`-axis 90 degrees in theta wrt cave" />
   <var name="phix"    value=" 0.0"   comment="align x`-axis  0 degrees in phi   wrt cave" />
   <var name="thetay"  value="90.0"   comment="align y`-axis 90 degrees in theta wrt cave" />
   <var name="phiy"    value="90.0"   comment="align y`-axis  0 degrees in phi   wrt cave" />
   <var name="thetaz"  value=" 0.0"   comment="align z`-axis  0 degrees in theta wrt cave" />
   <var name="phiz"    value=" 0.0"   comment="align z`-axis  0 degrees in phi   wrt cave" />

</Fill>

        
<!--  mmmmmmmmmmmmm  MATERIALS mmmmmmmmmmmmmmmmm    -->   

<Mixture name="CFiber" dens="1.713"  >
   <Component name="C" a="12" z="6" w="1"  />
</Mixture>
        
<Mixture name="Alumina" dens="3.90"  >
    <Component name="AL" a="27" z="13" w="2."  />
    <Component name="O" a="16" z="8" w="3."  />
 </Mixture>

<Mixture name="FR4" dens="1.80"  >
    <Component name="Si" a="28.08" z="14" w="0.6*1*28./60."  />
    <Component name="O" a="16" z="8" w="0.6*2*16./60."  />
    <Component name="C" a="12" z="6" w="0.4*8*12./174."  />
    <Component name="H" a="1" z="1" w="0.4*14*1./174."  />
    <Component name="O" a="16" z="8" w="0.4*4*16./174."  />
</Mixture>

<!--  mmmmmmmmmmmm initial  COMPUTATION mmmmmmmmmmmmmmmmmmmmmmmmmmm -->

inR     = IDSG_rM - IDSG_thick/2.
outR    = IDSG_rrRes + IDSG_r2Res
lengthZ = IDSG_lenM + 2.*IDSG_lenW 

centerZ = 0.

phi1=IDSG_angFlat-IDSG_angDel/2.
phi2=IDSG_angFlat+IDSG_angDel/2.

sinA = sin( IDSG_angflat * degrad )
cosA = cos( IDSG_angflat * degrad )


outRflat = IDSG_rW * cos(IDSG_angDel * degrad )
boxR     = (outRflat + inR + IDSG_thick)/2.


<!--  ASSEMBLE GEOMETRY, start with placing main volume in cave -->

<Create    block="IDSM"  />
<Placement block="IDSM"   >                   
    
    <Translation  x="IDSA_x"  y="IDSA_y"  z="IDSA_z" />

    <Rotation thetax="IDSA_thetax" phix="IDSA_phix"
              thetay="IDSA_thetay" phiy="IDSA_phiy"
              thetaz="IDSA_thetaz" phiz="IDSA_phiz" />

</Placement>

<!-- mmmmmmmmmmm   below no executable code outside Volumes mmmmmmmm  -->

<Volume       name="IDSM" comment="mother volume for beam support cone" >

    <Attribute for="IDSM" seen="0" colo="6"  />
    <Material name="Air"  />

    <Shape type="TUBE" rmin="inR"    rmax="outR"   dz="lengthZ/2."  />

    <Create    block="OSCA" />
    <Placement block="OSCA"  z="0"  /> 

    <!--  place east+werst cone  volumes -->  
    <Do var="k" from="0" to="1" >
        z1=lengthZ/2-IDSG_lenW/2.
        z2=IDSG_lenM/2.-IDSG_thick
        <If expr="k.eq.1"  >  
            z1=-lengthZ/2+IDSG_lenW/2. 
            z2=-IDSG_lenM/2.+IDSG_thick/2.
        </If>

        <Create    block="WSCC" />
        <Placement block="WSCC" z="z1"  /> 

        <Create    block="WSCD" />
        <Placement block="WSCD" z="z2"  /> 
     </Do>
  
 
     <!--  place TPC  resistor  volumes -->  
 
      <Do var="m" from="0" to="1" >

         angR = IDSG_angFlat - IDSG_dangRes/2.

         <If expr="m.eq.1"  >   
             angR = IDSG_angFlat+IDSG_dangRes/2.  
         </If>

         <Create    block="TPRT"/>
         <Placement block="TPRT" z="0" y="IDSG_rrRes*sin(angR/180.*3.1416)" x="IDSG_rrRes*cos(angR/180.*3.1416)"  />

     </Do>


    <Create    block="TPRR"/>
    <Placement block="TPRR"  z="0"  y="IDSG_rrRes*sinA" x="IDSG_rrRes*cosA"> 
          <Rotation alphaz="IDSG_angFlat"  />
    </Placement>

</Volume> <!-- end of mother volume -->
      

<Volume       name="OSCA" comment="middle cylinder, carbon fiber"  >
    <Attribute for="OSCA" seen="1" colo="5"  />
    <Material name="CFiber"  />
    <Shape type="TUBE"  rmin="inR"  rmax="inR+IDSG_thick" dz="IDSG_lenM/2."  />
</Volume>

<Volume       name="WSCC" comment=" east/west cylinder, carbon fiber"  >
    <Attribute for="WSCC" seen="0" colo="4"  />
    <Material name="Air"  />
    <Shape type="TUBE"   rmin="IDSG_rW-IDSG_thick/2."  rmax="IDSG_rW+IDSG_thick/2." dz="IDSG_lenW/2." />

    <Create    block="WSCO"/>
    <Placement block="WSCO"  z="0"  /> 

    <Create    block="WSCF"/>
    <Placement block="WSCF"  z="0"  y="outRflat*sinA" x="outRflat*cosA"> 
          <Rotation alphaz="IDSG_angFlat"  />
    </Placement>
</Volume>

<Volume       name="WSCO" comment=" circle carbon fiber"  >
    <Attribute for="WSCO" seen="1" colo="4"  />
    <Material name="CFiber"  />
    <Shape type="TUBS"  rmin="IDSG_rW-IDSG_thick/2."  rmax="IDSG_rW+IDSG_thick/2." dz="IDSG_lenW/2." 
                 phi2="phi1" phi1="phi2" />
</Volume>

<Volume       name="WSCF" comment=" flat carbon fiber"  >
    <Attribute for="WSCF" seen="1" colo="5"  />
    <Material name="CFiber"  />
    <Shape type="BOX" dz="IDSG_lenW/2." dx="IDSG_thick/2." dy="IDSG_rW*sin(IDSG_angDel/180.*3.1416)/2.0+0.6" />	
</Volume>


<Volume       name="WSCD" comment=" east/west disk, carbon fiber"  >
    <Attribute for="WSCD" seen="0" colo="2"  />
    <Material name="Air"  />
    <Shape type="TUBE"   rmin="IDSG_rM-IDSG_thick/2."  rmax="IDSG_rW+IDSG_thick/2." dz="IDSG_thick/2."  />

    <Create    block="WSCP"/>
    <Placement block="WSCP"  z="0"  /> 

    <Create    block="WSCB"/>
    <Placement block="WSCB"  z="0"  y="(outRflat+inR)/2.*sinA" x="(outRflat+inR)/2.*cosA"> 
          <Rotation alphaz="IDSG_angFlat"  />
    </Placement>
</Volume>


<Volume       name="WSCP" comment=" circle carbon fiber"  >
    <Attribute for="WSCP" seen="1" colo="6"  />
    <Material name="CFiber"  />
    <Shape type="TUBS"     rmin="IDSG_rM-IDSG_thick/2."  rmax="IDSG_rW+IDSG_thick/2." dz="IDSG_thick/2." 
                 phi2="phi1" phi1="phi2" />
</Volume>

<Volume       name="WSCB" comment=" box carbon fiber"  >
    <Attribute for="WSCB" seen="1" colo="7"  />
    <Material name="CFiber"  />
    <Shape type="BOX" dz="IDSG_thick/2." dx="(outRflat-inR)/2." dy="IDSG_rW*sin(IDSG_angDel/180.*3.1416)/1.85" />	
</Volume>
 
 <Volume       name="TPRR" comment=" TPC resistor" >
    <Attribute for="TPRR" seen="1" colo="8"  />
    <Material name="Alumina"  />
    <Shape type="BOX" dz="lengthZ/2." dx="IDSG_dxRes/2" dy="IDSG_dyRes/2." />
</Volume>


<Volume       name="TPRT" comment="resistor protection,  carbon fiber"  >
    <Attribute for="TPRT" seen="1" colo="9"  />
    <Material name="FR4"  />
    <Shape type="TUBE"  rmin="IDSG_r1Res"  rmax="IDSG_r2Res" dz="lengthZ/2."  />
</Volume>

</Module>
    

</Document>

