<Document file="StarVMC/Geometry/FgtdGeo/FgtdGeo3.xml">

<Module name="FGTDGEO3" comment=" forward GEM tracking detector for 2012 "  >

   <Created date="  4/12/2011 "  />
   <Author name="Jan Balewski MIT, Wei-Ming Zhang KSU"  />

   <CDE>AGECOM,GCUNIT,GCONST</CDE>

<!-- Key FGT volumes
   FGTM - mother i splaced in new beam support cone: IDSM
   FGTD - disk consisting of 4 quadrants:  FGTQ
   FGTQ quadrant is divided along z on to: front=FGTF, sensitive=FGZC, gem=FGTG, back=FGTB
   Unit depth spacers  at the edg of a quadrant:  FGQA, FGQB, FGQC , FGQD, FGQE, FGQF
-->

<!--                                                                =============================================================
                                                                    Declare the names of all volumes to be used in this geometry.
                                                                    Omitting a volume or including an extra one results in a run-
                                                                    time error.
                                                                    =============================================================
  -->
<Content  >
      FGTM, FGTD, FGTQ, FGZC, FGQA, 
      FGQB, FGQC, FGQD, FGQE, FGQF     
</Content>

<!--                                                                ==============================================================
                                                                    Local variables, some of which would be better setup in struct
                                                                    ==============================================================
  -->
<varlist type="float"> unitSpacerDZ/3.0/ </varlist>
<varlist type="int"> nQuad/4/ </varlist>
  

<varlist type="REAL"  >
     centerZ,lengthZ,
     diskLenZ,
     flatAng1,flatAng2,quad,disk,
     xx,diskZ
</varlist>



<!--                                                                 
                                                                     ============================================================
                                                                     Create and initialize structure defining detector parameters
                                                                     ============================================================
  -->

<Structure name="FGST"  >

   <var name="version" type="float" />

   <var name="startZ" />
   <var name="diskInR" />
   <var name="diskOutR" />

   <var name="diskStepZ" />
   <var name="flatOutR" />
   <var name="flatPerpAng" />
   <var name="frameWidth" />
   <var name="quadTiltAng" />

   <var name="frameFrontDZ" />
   <var name="frameSensDZ" />
   <var name="frameGemDZ" />
   <var name="frameBackDZ" />

   <var name="ndisk"      type="int" />

</Structure>

<!--                                                                 
                                                                     ============================================================
                                                                            Version 1.0 is a simple 2 disk installation
                                                                     ============================================================
  -->
<Fill name="FGST" comment="FGT Geometry data"  >

   <var name="version" value="1.0" comment="versioning of the FGST geometry data" />

   <var name="startZ" value="70." comment=" starting position along Z"  />
   <var name="diskStepZ" value="26" comment=" disk separation along Z"  />
   <var name="diskInR" value="10.35" comment=" inner radii for physical disk" />
   <var name="diskOutR" value="39.4" comment=" outer radii for physical disk" />
   <var name="flatOutR" value="37.0" comment=" outer radii for flat" />
   <var name="flatPerpAng" value="31.0" comment="angle of perp.to flat (deg)" />
   <var name="frameWidth" value="2.15" comment=" width of the quadrant frame" />
   <var name="quadTiltAng" value="-15.0" comment="angle of quadrant (deg)" />

   <var name="frameFrontDZ" value="2." comment=" quadrant front frame thicknes" />
   <var name="frameSensDZ" value="3." comment=" quadrant sensitive volum frame thicknes" />
   <var name="frameGemDZ" value="6." comment=" quadrant GEM frame thicknes" />
   <var name="frameBackDZ" value="2." comment=" quadrant back frame thicknes" />

   <var name="ndisk"   value="2"    comment="number of disks" />
    
</Fill>

<!--                                                                 
                                                                     ============================================================
                                                                            Version 2.0 is a complete 6 disk installation
                                                                     ============================================================
  -->

<Fill name="FGST" comment="FGT Geometry data"  >

   <var name="version" value="2.0" comment="versioning of the FGST geometry data" />

   <var name="startZ" value="70." comment=" starting position along Z"  />
   <var name="diskStepZ" value="10" comment=" disk separation along Z (WAG, jcw)" />
   <var name="diskInR" value="10.35" comment=" inner radii for physical disk" />
   <var name="diskOutR" value="39.4" comment=" outer radii for physical disk" />
   <var name="flatOutR" value="37.0" comment=" outer radii for flat" />
   <var name="flatPerpAng" value="31.0" comment="angle of perp.to flat (deg)" />
   <var name="frameWidth" value="2.15" comment=" width of the quadrant frame" />
   <var name="quadTiltAng" value="-15.0" comment="angle of quadrant (deg)" />

   <var name="frameFrontDZ" value="2." comment=" quadrant front frame thicknes" />
   <var name="frameSensDZ" value="3." comment=" quadrant sensitive volum frame thicknes" />
   <var name="frameGemDZ" value="6." comment=" quadrant GEM frame thicknes" />
   <var name="frameBackDZ" value="2." comment=" quadrant back frame thicknes" />

   <var name="ndisk"   value="6"    comment="number of disks" />
    
</Fill>
        
                                                                         <!--  mmmmmmmmmmmmm  MATERIALS mmmmmmmmmmmmmmmmm    -->   
        
<Mixture name="ArCO2_70_30" dens="0.0018015" isvol="1"  >
   <Component name="Ar" a="39.95" z="18." w="0.7"  />
   <Component name="C" a="12.01" z="6." w="0.3*1*12.01/44.01"  />
   <Component name="O" a="16." z="8." w="0.3*2*16./44.01"  />
</Mixture>
        
<Mixture name="FR4" dens="1.80"  >
    <Component name="Si" a="28.08" z="14" w="0.6*1*28./60."  />
    <Component name="O" a="16" z="8" w="0.6*2*16./60."  />
    <Component name="C" a="12" z="6" w="0.4*8*12./174."  />
    <Component name="H" a="1" z="1" w="0.4*14*1./174."  />
    <Component name="O" a="16" z="8" w="0.4*4*16./174."  />
</Mixture>


<Use struct="FGST" select="version" value="2.0" />
                                                                   <!--  mmmmmmmmmmmm  COMPUTATION mmmmmmmmmmmmmmmmmmmmmmmmmmm -->


<!--  Quad disk dept: front+sens+gem+back -->
diskLenZ=FGST_frameFrontDZ+FGST_frameSensDZ+FGST_frameGemDZ+FGST_frameBackDZ <!-- total disk thicness -->

lengthZ = FGST_ndisk*FGST_diskStepZ+diskLenZ
centerZ = FGST_startZ+lengthZ/2.0

xx=acos(FGST_flatOutR/FGST_diskOutR) <!-- half opening angle of the flat (rad) -->
flatAng1=FGST_flatPerpAng-xx/degrad
flatAng2=FGST_flatPerpAng+xx/degrad <!-- angle limits of the flat (deg) -->


                                                               <!--  ASSEMBLE GEOMETRY, start with placing main volume in cave -->

<Create    block="FGTM"  />
<Placement block="FGTM" in="IDSM" z="centerZ" />

<!-- below no executable code outside Volumes -->

<Volume       name="FGTM" comment="mother volume for FGT assembly" >

    <Attribute for="FGTM" seen="0" colo="6"  />
    <Material name="Air"  />
    <Shape type="TUBE" rmin="FGST_diskInR"    rmax="FGST_diskOutR"   dz="lengthZ/2.0"  />

    <!-- place disk(s) inside FGT mother volume -->

    <Do var="disk" from="1" to="FGST_ndisk"  >
       diskZ=-lengthZ/2. + diskLenZ*(disk-0.5) + (disk-1.0)*FGST_diskStepZ 
       <Create    block="FGTD"  />
       <Placement block="FGTD"  z="diskZ" >
           <Rotation alphaz="FGST_quadTiltAng"  />
       </Placement>
    </Do>

</Volume>
     


<Volume       name="FGTD" comment="mother volume for FGT disk" >

    <Attribute for="FGTD" seen="0" colo="1"  />
    <Material name="Air"  />
    <Shape type="TUBE" rmin="FGST_diskInR"    rmax="FGST_diskOutR"   dz="diskLenZ/2.0"  />   
   
    <!--  place quadrants within one disk , temporary skip quad=1 -->

    <Do var="quad" from="1" to="nQuad"  >

       <Create    block="FGTQ"  />
       <Placement block="FGTQ" z="0." >
           <Rotation alphaz="(1-quad)*90."  />
       </Placement>

     </Do>
  
</Volume> 


<Volume       name="FGTQ" comment="quadrant "  >

    <Attribute for="FGTQ" seen="0" colo="4"  />
    <Material name="ArCO2_70_30"  />
    <Shape type="TUBS"  rmin="FGST_diskInR"  rmax="FGST_diskOutR" dz="diskLenZ/2." phi1="0." phi2="90." />
    <Create    block="FGZC"  />
    <Placement block="FGZC" z="-diskLenZ/2.+FGST_frameFrontDZ+FGST_frameSensDZ/2." /> 

</Volume> 

<Volume       name="FGZC" comment="quadrant sensitive volume"  >

    <Attribute for="FGZC" seen="0" colo="1"  />
    <Material name="ArCO2_70_30"  />
    <Material name="Sensitive_fgt_gas" isvol="1"  />
    <Shape type="TUBS"  rmin="FGST_diskInR"  rmax="FGST_diskOutR" dz="FGST_frameSensDZ/2." phi1="0." phi2="90." />

    <Instrument block="FGZC">
        <Hit meas="Z" bins="0.001" opts="S" />
        <Hit meas="Y" bins="0.001"          />
        <Hit meas="X" bins="0.001"          />
        <Hit meas="ptot" nbits="16" min="0" max="100" />
        <Hit meas="cx" nbits="10" />
        <Hit meas="cy" nbits="10" />
        <Hit meas="cz" nbits="10" />
        <Hit meas="sleng" nbits="16" min="0" max="500" />
        <Hit meas="tof" nbits="16" min="0" max="1.0E-6" />
        <Hit meas="step" bins="0.01" />
        <Hit meas="eloss" nbits="16" min="0" max="0.001" />
    </Instrument>

    <Create    block="FGQA"  />
    <Placement block="FGQA" x="FGST_frameWidth/2." y="(FGST_diskOutR+FGST_diskInR)/2."/> 

    <Create    block="FGQB"   />
    <Placement block="FGQB" /> 

    <Create    block="FGQC"  />
    <Placement block="FGQC" y="FGST_frameWidth/2." x="(FGST_diskOutR+FGST_diskInR)/2."/> 

    <Create    block="FGQD"  />
    <Placement block="FGQD" /> 

    <Create    block="FGQE"  />
    <Placement block="FGQE" x="(FGST_flatOutR-FGST_frameWidth/2.)*cos(FGST_flatPerpAng*degrad)" y="(FGST_flatOutR-FGST_frameWidth/2.)*sin(FGST_flatPerpAng*degrad)" >
           <Rotation alphaz="FGST_flatPerpAng-90."  />
    </Placement>

    <Create    block="FGQF"  />
    <Placement block="FGQF" /> 
   
</Volume>



<Volume       name="FGQA" comment="C-spacer"  >
    <Attribute for="FGQA" seen="1" colo="2"  />
    <Material name="FR4"  />
    <Shape type="BOX" dz="unitSpacerDZ/2." dx="FGST_frameWidth/2." dy="(FGST_diskOutR-FGST_diskInR-FGST_frameWidth)/2."/> 
</Volume>

<Volume       name="FGQB" comment="B-spacer, arc"  >
    <Attribute for="FGQB" seen="1" colo="3"  />
    <Material name="FR4"  />
    <Shape type="TUBS"  rmin="FGST_diskInR"  rmax="FGST_diskInR+FGST_frameWidth"  phi1="0." phi2="90." dz="unitSpacerDZ/2."/>
</Volume>
  
<Volume       name="FGQC" comment="C-spacer, bar"  >
    <Attribute for="FGQC" seen="1" colo="2"  />
    <Material name="FR4"  />
    <Shape type="BOX" dz="unitSpacerDZ/2." dy="FGST_frameWidth/2." dx="(FGST_diskOutR-FGST_diskInR-FGST_frameWidth)/2."/> 
</Volume>
  
<Volume       name="FGQD" comment="D-spacer, arc"  >
    <Attribute for="FGQD" seen="1" colo="3"  />
    <Material name="FR4"  />
    <Shape type="TUBS"  rmin="FGST_diskOutR-FGST_frameWidth"  rmax="FGST_diskOutR"  phi1="0." phi2="flatAng1" dz="unitSpacerDZ/2." />
</Volume>


<Volume       name="FGQE" comment="E-spacer, flat"  >
    <Attribute for="FGQE" seen="1" colo="2"  />
    <Material name="FR4"  />
    <Shape type="BOX" dz="unitSpacerDZ/2."  dy="FGST_frameWidth/2." dx="FGST_diskOutR*sin(( flatAng2-flatAng1)*degrad/2.)" /> 
</Volume>

<Volume       name="FGQF" comment="F-spacer, arc"  >
    <Attribute for="FGQF" seen="1" colo="3"  />
    <Material name="FR4"  />
    <Shape type="TUBS"  rmin="FGST_diskOutR-FGST_frameWidth"  rmax="FGST_diskOutR"  phi1="flatAng2" phi2="90."  dz="unitSpacerDZ/2." />
</Volume>

  
</Module>
</Document>

