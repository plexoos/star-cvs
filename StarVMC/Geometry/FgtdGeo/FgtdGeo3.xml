<Document file="StarVMC/Geometry/FgtdGeo/FgtdGeo3.xml">

<Module name="FGTDGEO3" comment=" forward GEM tracking detector for 2012 "  >

   <Created date="  4/12/2011 "  />
   <Author name="Jan Balewski MIT, Wei-Ming Zhang KSU"  />

   <CDE>AGECOM,GCUNIT,GCONST</CDE>

<!-- Key FGT volumes
   FGTM - mother i splaced in new beam support cone: IDSM
   FGTD - disk consisting of 4 quadrants:  FGTQ
   FGTQ quadrant is divided along z on to: front=FGTF, sensitive=FGZC, gem=FGTG, back=FGTB
   Unit depth spacers  at the edg of a quadrant:  FGQA, FGQB, FGQC , FGQD, FGQE, FGQF
-->

<!--  =============================================================
   Declare the names of all volumes to be used in this geometry.
   Omitting a volume or including an extra one results in a run-
    time error.
   =============================================================
  -->
<Content  >
      FGTM, FGTD, FGTQ, FGZC, FGQA, 
      FGQB, FGQC, FGQD, FGQE, FGQF     
</Content>

<!--    ==============================================================
  Local variables, some of which would be better setup in struct
   ==============================================================
  -->
<varlist type="float"> unitSpacerDZ/3.0/ </varlist>

<varlist  type="float"  comment=" inner radii for physical disk" >  diskInR/10.35/  </varlist>
<varlist  type="float"  comment=" outer radii for physical disk" >  diskOutR/39.4/ </varlist>
<varlist  type="float"  comment=" outer radii for flat" > flatOutR/37.0/   </varlist>
<varlist  type="float"  comment=" angle of perp.to flat (deg)">  flatPerpAng/31.0/    </varlist>
<varlist  type="float"  comment=" width of the quadrant frame" >   frameWidth/2.15/   </varlist>
<varlist  type="float"  comment=" angle of quadrant (deg)" >   quadTiltAng/-15.0/ </varlist>
<varlist  type="float"  comment=" quadrant front frame thicknes" >   frameFrontDZ/2./  </varlist>
<varlist  type="float"  comment=" quadrant sensitive volum frame thicknes" > frameSensDZ/3./ </varlist>
<varlist  type="float"  comment=" quadrant GEM frame thicknes" >  frameGemDZ/6./ </varlist>
<varlist  type="float"  comment=" quadrant back frame thicknes" >   frameBackDZ/2./ </varlist>


<varlist type="REAL"  >
     centerZ,lengthZ,
     diskLenZ,
     flatAng1,flatAng2,quad,disk,
     xx,diskZ
</varlist>



<!--                                                                 
     ============================================================
  Create and initialize structure defining detector parameters 
  (aka configuration)
  ============================================================
  -->

<Structure name="FGGG">
   <var name="FgstConfig"  type="float" />
</Structure>

<Structure name="FGST"  >
   <var name="config" type="float" />
   <var name="startZ"  type="float" />
   <var name="diskStepZ" type="float"  />  
   <var name="ndisk"      type="int" />
   <var name="nQuad"      type="int"/>
</Structure>

<!--                                                                 
  ============================================================
  Control structure, interfaced through AgDETP
   ============================================================
  -->
<Fill name="FGGG" comment="FGT Geometry Control Structure">
   <var name="FgstConfig" value="2.0" comment="selection of no. of disks and quadrants " />
</Fill>


<!--                                                                 
  ============================================================
  Version 1.0  has 6 3/4 disks
 ============================================================
  -->
<Fill name="FGST" comment="FGT Geometry data"  >
   <var name="config" value="1.0" comment="versioning of the FGST geometry data" />

   <var name="startZ" value="70." comment=" starting position along Z"  />
   <var name="diskStepZ" value="10." comment=" disk separation along Z"  />
   <var name="ndisk"   value="6"    comment="number of disks" />
   <var name="nQuad"   value="3"    comment="number quadrants in a disks" />
    
</Fill>


<!--                                                                 
  ============================================================
  Version 2.0  has  3 full  disks
 ============================================================
  -->
<Fill name="FGST" comment="FGT Geometry data"  >
   <var name="config" value="2.0" comment="versioning of the FGST geometry data" />

   <var name="startZ" value="70." comment=" starting position along Z"  />
   <var name="diskStepZ" value="15." comment=" disk separation along Z"  />
   <var name="ndisk"   value="3"    comment="number of disks" />
   <var name="nQuad"   value="4"    comment="number quadrants in a disks" />

</Fill>

<!--                                                                 
  ============================================================
  Version 3.0  has  2 full  disks
 ============================================================
  -->
<Fill name="FGST" comment="FGT Geometry data"  >
   <var name="config" value="3.0" comment="versioning of the FGST geometry data" />

   <var name="startZ" value="70." comment=" starting position along Z"  />
   <var name="diskStepZ" value="50." comment=" disk separation along Z"  />
   <var name="ndisk"   value="2"    comment="number of disks" />
   <var name="nQuad"   value="4"    comment="number quadrants in a disks" />

</Fill>

<!--                                                                 
  ============================================================
  Version 4.0  has  6   1/4 disks
 ============================================================
  -->
<Fill name="FGST" comment="FGT Geometry data"  >
   <var name="config" value="4.0" comment="versioning of the FGST geometry data" />

   <var name="startZ" value="70." comment=" starting position along Z"  />
   <var name="diskStepZ" value="15." comment=" disk separation along Z"  />
   <var name="ndisk"   value="6"    comment="number of disks" />
   <var name="nQuad"   value="1"    comment="number quadrants in a disks" />

</Fill>


 <!--  mmmmmmmmmmmmm  MATERIALS mmmmmmmmmmmmmmmmm    -->   
        
<Mixture name="ArCO2_70_30" dens="0.0018015" isvol="1"  >
   <Component name="Ar" a="39.95" z="18." w="0.7"  />
   <Component name="C" a="12.01" z="6." w="0.3*1*12.01/44.01"  />
   <Component name="O" a="16." z="8." w="0.3*2*16./44.01"  />
</Mixture>
        
<Mixture name="FR4" dens="1.80"  >
    <Component name="Si" a="28.08" z="14" w="0.6*1*28./60."  />
    <Component name="O" a="16" z="8" w="0.6*2*16./60."  />
    <Component name="C" a="12" z="6" w="0.4*8*12./174."  />
    <Component name="H" a="1" z="1" w="0.4*14*1./174."  />
    <Component name="O" a="16" z="8" w="0.4*4*16./174."  />
</Mixture>


<Use struct="FGGG" />
<Use struct="FGST" select="config" value="FGGG_FgstConfig" />

 <!--  mmmmmmmmmmmm  COMPUTATION mmmmmmmmmmmmmmmmmmmmmmmmmmm -->


<!--  Quad disk dept: front+sens+gem+back -->
diskLenZ=frameFrontDZ+frameSensDZ+frameGemDZ+frameBackDZ <!-- total disk thicness -->

lengthZ = FGST_ndisk*(FGST_diskStepZ+diskLenZ)
centerZ = FGST_startZ+lengthZ/2.0

xx=acos(flatOutR/diskOutR) <!-- half opening angle of the flat (rad) -->
flatAng1=flatPerpAng-xx/degrad
flatAng2=flatPerpAng+xx/degrad <!-- angle limits of the flat (deg) -->


 <!--  ASSEMBLE GEOMETRY, start with placing main FGT volume in the support cone -->

<Create    block="FGTM"  />
<Placement block="FGTM" in="IDSM" z="centerZ" />

<!-- below no executable code outside Volumes -->

<Volume       name="FGTM" comment="mother volume for FGT assembly" >

    <Attribute for="FGTM" seen="1" colo="6"  />
    <Material name="Air"  />
    <Shape type="TUBE" rmin="diskInR"    rmax="diskOutR"   dz="lengthZ/2.0"  />

    <!-- place disk(s) inside FGT mother volume -->

    <Do var="disk" from="1" to="FGST_ndisk"  >
       diskZ=-lengthZ/2. +diskLenZ/2. + (disk-1.0)*FGST_diskStepZ 
       <Create    block="FGTD"  />
       <Placement block="FGTD"  z="diskZ" >
           <Rotation alphaz="quadTiltAng"  />
       </Placement>
    </Do>
 
</Volume>
     


<Volume       name="FGTD" comment="mother volume for FGT disk" >

    <Attribute for="FGTD" seen="0" colo="1"  />
    <Material name="Air"  />
    <Shape type="TUBE" rmin="diskInR"    rmax="diskOutR"   dz="diskLenZ/2.0"  />   
   
    <!--  place quadrants within one disk , temporary skip quad=1 -->

    <Do var="quad" from="1" to="FGST_nQuad"  >

       <Create    block="FGTQ"  />
       <Placement block="FGTQ" z="0." >
           <Rotation alphaz="(1-quad)*90."  />
       </Placement>

     </Do>
  
</Volume> 


<Volume       name="FGTQ" comment="quadrant "  >

    <Attribute for="FGTQ" seen="0" colo="4"  />
    <Material name="ArCO2_70_30"  />
    <Shape type="TUBS"  rmin="diskInR"  rmax="diskOutR" dz="diskLenZ/2." phi1="0." phi2="90." />
    <Create    block="FGZC"  />
    <Placement block="FGZC" z="-diskLenZ/2.+frameFrontDZ+frameSensDZ/2." /> 

</Volume> 

<Volume       name="FGZC" comment="quadrant sensitive volume"  >

    <Attribute for="FGZC" seen="0" colo="1"  />
    <Material name="ArCO2_70_30"  />
    <Material name="Sensitive_fgt_gas" isvol="1"  />
    <Shape type="TUBS"  rmin="diskInR"  rmax="diskOutR" dz="frameSensDZ/2." phi1="0." phi2="90." />

    <Instrument block="FGZC">
        <Hit meas="Z" bins="0.001" opts="S" />
        <Hit meas="Y" bins="0.001"          />
        <Hit meas="X" bins="0.001"          />
        <Hit meas="ptot" nbits="16" min="0" max="100" />
        <Hit meas="cx" nbits="10" />
        <Hit meas="cy" nbits="10" />
        <Hit meas="cz" nbits="10" />
        <Hit meas="sleng" nbits="16" min="0" max="500" />
        <Hit meas="tof" nbits="16" min="0" max="1.0E-6" />
        <Hit meas="step" bins="0.01" />
        <Hit meas="eloss" nbits="16" min="0" max="0.001" />
    </Instrument>

    <Create    block="FGQA"  />
    <Placement block="FGQA" x="frameWidth/2." y="(diskOutR+diskInR)/2."/> 

    <Create    block="FGQB"   />
    <Placement block="FGQB" /> 

    <Create    block="FGQC"  />
    <Placement block="FGQC" y="frameWidth/2." x="(diskOutR+diskInR)/2."/> 

    <Create    block="FGQD"  />
    <Placement block="FGQD" /> 

    <Create    block="FGQE"  />
    <Placement block="FGQE" x="(flatOutR-frameWidth/2.)*cos(flatPerpAng*degrad)" y="(flatOutR-frameWidth/2.)*sin(flatPerpAng*degrad)" >
           <Rotation alphaz="flatPerpAng-90."  />
    </Placement>

    <Create    block="FGQF"  />
    <Placement block="FGQF" /> 
   
</Volume>



<Volume       name="FGQA" comment="C-spacer"  >
    <Attribute for="FGQA" seen="1" colo="2"  />
    <Material name="FR4"  />
    <Shape type="BOX" dz="unitSpacerDZ/2." dx="frameWidth/2." dy="(diskOutR-diskInR-frameWidth)/2."/> 
</Volume>

<Volume       name="FGQB" comment="B-spacer, arc"  >
    <Attribute for="FGQB" seen="1" colo="3"  />
    <Material name="FR4"  />
    <Shape type="TUBS"  rmin="diskInR"  rmax="diskInR+frameWidth"  phi1="0." phi2="90." dz="unitSpacerDZ/2."/>
</Volume>
  
<Volume       name="FGQC" comment="C-spacer, bar"  >
    <Attribute for="FGQC" seen="1" colo="2"  />
    <Material name="FR4"  />
    <Shape type="BOX" dz="unitSpacerDZ/2." dy="frameWidth/2." dx="(diskOutR-diskInR-frameWidth)/2."/> 
</Volume>
  
<Volume       name="FGQD" comment="D-spacer, arc"  >
    <Attribute for="FGQD" seen="1" colo="3"  />
    <Material name="FR4"  />
    <Shape type="TUBS"  rmin="diskOutR-frameWidth"  rmax="diskOutR"  phi1="0." phi2="flatAng1" dz="unitSpacerDZ/2." />
</Volume>


<Volume       name="FGQE" comment="E-spacer, flat"  >
    <Attribute for="FGQE" seen="1" colo="2"  />
    <Material name="FR4"  />
    <Shape type="BOX" dz="unitSpacerDZ/2."  dy="frameWidth/2." dx="diskOutR*sin(( flatAng2-flatAng1)*degrad/2.)" /> 
</Volume>

<Volume       name="FGQF" comment="F-spacer, arc"  >
    <Attribute for="FGQF" seen="1" colo="3"  />
    <Material name="FR4"  />
    <Shape type="TUBS"  rmin="diskOutR-frameWidth"  rmax="diskOutR"  phi1="flatAng2" phi2="90."  dz="unitSpacerDZ/2." />
</Volume>

  
</Module>
</Document>

