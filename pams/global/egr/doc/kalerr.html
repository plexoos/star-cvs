<head>
<title>
Kalman fit errors
</title>
<body bcolor=ffffff>
<h1 align=center>Kalman Filter Fit Failures as Defined in iflag</h1>
<pre>

-iflag = 1000 -> fewer than 4 hits before attempting any fitting
         1001 -> not enough hits after filtering and smoothing
         1000 + tpcact(ierr) -> tracking through "active" volume
                       ierr = 100 -> hits out of order radially
                              200 + vxtbrd(ierr) -> tracking in the barrel region
                                           ierr = 1 -> radius of surface < 1.E-10
                                           ierr = 11 -> radius from origin < 1.D-10
                                           ierr = 12 -> asin(dphi) > 1.
                              400 + ktprem(ierr) -> prediction with multiple scattering
                                           ierr = 1 -> prediction step out of range
                                           ierr = 2 -> matrix inversion failed
                              500 + ktmeas(ierr) -> store measurement
                                           ierr = 1 -> cov. matrix of measurement not positive
                                                       definite
                                           ierr = 2 -> measurement out of storage bounds
                              600 + ktfilt(ierr) -> filter step
                                           ierr = 1 -> matrix inversion failed
                              700 + ktfch2(ierr) -> filtered chisq update
                                           ierr = 1 -> matrix inversion failed
                                           ierr = 2 -> chisq negative
                                           ierr = 3 -> diagonal elements of the residuals
                                                       covariance matrix are negative
         2000 + ktsch2(ierr) -> calculate smoothed chisq update (first hit)
                       ierr = 1 -> matrix inversion failed
                       ierr = 2 -> chisq negative
                       ierr = 3 -> diagonal elements of the residuals
                                   covariance matrix are negative
         3000 + ktsout(ierr) -> remove outlier during smoothing (first hit)
                       ierr = 1 -> matrix inversion failed 
         4000 + ktsmoo(ierr) -> smoother step
                       ierr = 1 -> wrong step index
         5000 + ktsch2(ierr) -> smoothing (for second hit and others)
                       ierr = 1 -> matrix inversion failed
                       ierr = 2 -> chisq negative
                       ierr = 3 -> diagonal elements of the residuals
                                   covariance matrix are negative
         6000 + ktsout(ierr) -> remove outlier during smoothing(second hit
                                and others)
         7000 + ktrepr(ierr) -> prediction during refitting during evaluation
                       ierr = 1 -> index out of range
                       ierr = 2 -> matrix inversion failed
         8000 + ktfilt(ierr) -> filtering of track vector during evaluation
                       ierr = 1 -> matrix inversion failed
         9000 + ktfch2(ierr) -> remove outlier during evaluation
                       ierr = 1 -> matrix inversion failed
                       ierr = 2 -> chisq negative
                       ierr = 3 -> diagonal elements of the residuals
                                   covariance matrix are negative
        10000 + ktsch2(ierr) -> more smoothing (first hit)
        11000 + ktsmoo(ierr) -> more smoothing
        12000 + ktsch2(ierr) -> more smoothing (rest of hits)

</pre>
<hr>
<i>Last modified 30 May 2000 by A.C. Saulys</i>
</body>
      